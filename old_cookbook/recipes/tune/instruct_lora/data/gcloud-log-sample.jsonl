{"query": "Find the frequency of error severity logs related to the gateway application over the last hour.", "request": "{\"query_str\": \"severity:ERROR labels.k8s-pod/app_kubernetes_io/name:gateway\", \"groupby_fields\": [], \"aggregation_function\": \"count\", \"aggregation_field\": \"count\", \"viz\": \"stream\", \"start\": \"now-1h\", \"end\": \"now\"}", "sample": "- protoPayload.resourceName:projects/0000004d1a204d3f resource.labels.project_id:fw-ai-cp-prod receiveTimestamp:2023-08-10T04:02:49.894402565Z protoPayload.authorizationInfo[0].resource:projects/0000004d1a204d3f protoPayload.request.filter:\"noteProjectId = \"goog-analysis\" AND noteId = \"PACKAGE_VULNERABILITY\" AND resourceUrl = \"https://us-docker.pkg.dev/fw-ai-cp-prod/data-plane/firecharts-aws@sha256:e6a05bc17bcf47548c9f10c0e8bbaa8c59ed7a353ba70e413e82a7640d92163f\"\" protoPayload.authorizationInfo[0].granted:True resource.labels.method:grafeas.v1.Grafeas.ListOccurrences protoPayload.serviceName:containeranalysis.googleapis.com protoPayload.requestMetadata.destinationAttributes:{} protoPayload.request.@type:type.googleapis.com/grafeas.v1.ListOccurrencesRequest protoPayload.authorizationInfo[0].resourceAttributes:{} protoPayload.authorizationInfo[0].permission:containeranalysis.occurrences.list protoPayload.@type:type.googleapis.com/google.cloud.audit.AuditLog\n- resource.labels.cluster_name:control-plane-2 resource.labels.location:us-west1 textPayload:\"[2023-08-10 04:02:49.461][1][debug][main] [source/server/server.cc:265] flushing stats\" receiveTimestamp:2023-08-10T04:02:49.668675099Z resource.type:k8s_container timestamp:2023-08-10T04:02:49.462304325Z labels.k8s-pod/app_kubernetes_io/name:gateway labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q\n- operation.id:206557c6-91bd-47d4-ab30-6d66691b1a59 labels.authorization.k8s.io/decision:allow protoPayload.authorizationInfo[0].resource:coordination.k8s.io/v1/namespaces/kube-system/leases/vpa-recommender operation.first:True protoPayload.authorizationInfo[0].permission:io.k8s.coordination.v1.leases.update protoPayload.requestMetadata.callerSuppliedUserAgent:\"vpa-recommender/v0.0.0 (linux/amd64) kubernetes/$Format\" protoPayload.@type:type.googleapis.com/google.cloud.audit.AuditLog logName:projects/fw-ai-cp-prod/logs/cloudaudit.googleapis.com%2Factivity resource.labels.project_id:fw-ai-cp-prod protoPayload.resourceName:coordination.k8s.io/v1/namespaces/kube-system/leases/vpa-recommender receiveTimestamp:2023-08-10T04:02:50.401000436Z operation.producer:k8s.io\n- operation.last:True protoPayload.authenticationInfo.principalEmail:system:clustermetrics protoPayload.methodName:io.k8s.core.v1.configmaps.update protoPayload.authorizationInfo[0].resource:core/v1/namespaces/kube-system/configmaps/clustermetrics protoPayload.resourceName:core/v1/namespaces/kube-system/configmaps/clustermetrics resource.labels.project_id:fw-ai-cp-prod protoPayload.serviceName:k8s.io operation.producer:k8s.io protoPayload.requestMetadata.callerSuppliedUserAgent:clustermetrics insertId:11d3783b-eb10-408a-a767-b529edeedbe2 resource.labels.cluster_name:inference-1 protoPayload.requestMetadata.callerIp:172.16.0.3\n- logName:projects/fw-ai-cp-prod/logs/stderr textPayload:\"[2023-08-10 04:02:48.596][1][debug][conn_handler] [source/extensions/listener_managers/listener_manager/active_stream_listener_base.cc:120] [C2906] adding to cleanup list\" resource.type:k8s_container resource.labels.namespace_name:default severity:ERROR resource.labels.cluster_name:control-plane-2 labels.k8s-pod/app_kubernetes_io/name:gateway insertId:rgbxsdckctqg81fw\n- timestamp:2023-08-10T04:02:48.597418292Z receiveTimestamp:2023-08-10T04:02:49.668675099Z textPayload:\"[2023-08-10 04:02:48.596][1][debug][connection] [source/common/network/connection_impl.cc:250] [C2906] closing socket: 1\" resource.labels.namespace_name:default labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q labels.k8s-pod/app_kubernetes_io/instance:dev-zchenyu resource.type:k8s_container resource.labels.project_id:fw-ai-cp-prod\n- receiveTimestamp:2023-08-10T04:02:49.668675099Z insertId:wsvz7o7v2zbal962 resource.labels.location:us-west1 resource.type:k8s_container timestamp:2023-08-10T04:02:48.597416172Z resource.labels.project_id:fw-ai-cp-prod resource.labels.pod_name:gateway-dev-zchenyu-69fb9f646f-7pw2t labels.k8s-pod/pod-template-hash:69fb9f646f\n- resource.labels.namespace_name:default labels.k8s-pod/app_kubernetes_io/instance:dev-zchenyu resource.labels.cluster_name:control-plane-2 textPayload:\"[2023-08-10 04:02:48.596][1][debug][conn_handler] [source/extensions/listener_managers/listener_manager/active_stream_listener_base.cc:120] [C2905] adding to cleanup list\" receiveTimestamp:2023-08-10T04:02:49.668675099Z severity:ERROR labels.k8s-pod/app_kubernetes_io/name:gateway resource.type:k8s_container\n- timestamp:2023-08-10T04:02:48.597410881Z resource.labels.container_name:envoy resource.labels.namespace_name:default resource.labels.project_id:fw-ai-cp-prod labels.k8s-pod/app_kubernetes_io/name:gateway resource.labels.pod_name:gateway-dev-zchenyu-69fb9f646f-7pw2t insertId:mmik8btwv74v1zt3 resource.labels.cluster_name:control-plane-2\n- resource.labels.project_id:fw-ai-cp-prod labels.k8s-pod/app_kubernetes_io/instance:dev-zchenyu resource.labels.cluster_name:control-plane-2 labels.k8s-pod/pod-template-hash:69fb9f646f labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q severity:ERROR insertId:rfie97f5cbsdcubb labels.k8s-pod/app_kubernetes_io/name:gateway"}
{"query": "Show me a stream of the error severity logs where the associated Kubernetes pod has an instance labelled dev-zchenyu from control plane 2, in the last half an hour.", "request": "{\"query_str\": \"severity:ERROR labels.k8s-pod/app_kubernetes_io/instance:dev-zchenyu resource.labels.cluster_name:control-plane-2\", \"groupby_fields\": [], \"aggregation_function\": \"\", \"aggregation_field\": \"\", \"viz\": \"stream\", \"start\": \"now-30m\", \"end\": \"now\"}", "sample": "- severity:ERROR resource.labels.pod_name:gateway-dev-zchenyu-69fb9f646f-7pw2t resource.labels.container_name:envoy textPayload:\"[2023-08-10 04:02:48.596][1][debug][connection] [source/common/network/connection_impl.cc:139] [C2906] closing data_to_write=243 type=2\" labels.k8s-pod/app_kubernetes_io/instance:dev-zchenyu resource.labels.cluster_name:control-plane-2 resource.labels.project_id:fw-ai-cp-prod timestamp:2023-08-10T04:02:48.597390521Z\n- labels.k8s-pod/pod-template-hash:69fb9f646f timestamp:2023-08-10T04:02:48.597388452Z insertId:i5zplb90dhvzycne labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q receiveTimestamp:2023-08-10T04:02:49.668675099Z resource.labels.container_name:envoy resource.labels.namespace_name:default textPayload:\"[2023-08-10 04:02:48.596][1][debug][connection] [source/common/network/connection_impl.cc:139] [C2906] closing data_to_write=243 type=0\"\n- labels.k8s-pod/pod-template-hash:69fb9f646f resource.labels.cluster_name:control-plane-2 textPayload:\"[2023-08-10 04:02:48.596][1][debug][misc] [source/server/admin/admin_filter.cc:101] nextChunk: response.length=5 more_data=false end_stream=true\" labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q resource.labels.location:us-west1 labels.k8s-pod/app_kubernetes_io/name:gateway timestamp:2023-08-10T04:02:48.597386341Z resource.labels.project_id:fw-ai-cp-prod\n- resource.labels.pod_name:gateway-dev-zchenyu-69fb9f646f-7pw2t labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q insertId:awh1jsm0qtwlejrf resource.labels.namespace_name:default resource.labels.project_id:fw-ai-cp-prod labels.k8s-pod/app_kubernetes_io/instance:dev-zchenyu logName:projects/fw-ai-cp-prod/logs/stderr severity:ERROR\n- resource.labels.namespace_name:default labels.k8s-pod/app_kubernetes_io/instance:dev-zchenyu resource.type:k8s_container resource.labels.cluster_name:control-plane-2 logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.pod_name:gateway-dev-zchenyu-69fb9f646f-7pw2t receiveTimestamp:2023-08-10T04:02:49.668675099Z timestamp:2023-08-10T04:02:48.597381341Z\n- labels.k8s-pod/app_kubernetes_io/instance:dev-zchenyu textPayload:\"'server', 'envoy'\" severity:ERROR resource.labels.pod_name:gateway-dev-zchenyu-69fb9f646f-7pw2t resource.labels.namespace_name:default resource.labels.cluster_name:control-plane-2 resource.type:k8s_container labels.k8s-pod/pod-template-hash:69fb9f646f\n- resource.type:k8s_container labels.k8s-pod/app_kubernetes_io/instance:dev-zchenyu receiveTimestamp:2023-08-10T04:02:49.668675099Z labels.k8s-pod/pod-template-hash:69fb9f646f resource.labels.location:us-west1 logName:projects/fw-ai-cp-prod/logs/stderr labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q resource.labels.container_name:envoy\n- labels.k8s-pod/app_kubernetes_io/name:gateway resource.labels.namespace_name:default receiveTimestamp:2023-08-10T04:02:49.668675099Z resource.labels.container_name:envoy textPayload:\"'x-content-type-options', 'nosniff'\" logName:projects/fw-ai-cp-prod/logs/stderr resource.type:k8s_container resource.labels.location:us-west1\n- resource.labels.namespace_name:default timestamp:2023-08-10T04:02:48.597360701Z resource.type:k8s_container resource.labels.pod_name:gateway-dev-zchenyu-69fb9f646f-7pw2t labels.k8s-pod/app_kubernetes_io/instance:dev-zchenyu labels.k8s-pod/app_kubernetes_io/name:gateway labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q resource.labels.cluster_name:control-plane-2\n- resource.labels.container_name:envoy severity:ERROR labels.k8s-pod/pod-template-hash:69fb9f646f labels.k8s-pod/app_kubernetes_io/name:gateway resource.labels.pod_name:gateway-dev-zchenyu-69fb9f646f-7pw2t timestamp:2023-08-10T04:02:48.597356181Z insertId:bb2yuiyd1u3cau3a receiveTimestamp:2023-08-10T04:02:49.668675099Z"}
{"query": "Locate error severity logs for the Envoy container running specifically on control-plane-2 with logs that were timestamped on August 10, 2023.", "request": "{\"query_str\": \"severity:ERROR resource.labels.container_name:envoy resource.labels.cluster_name:control-plane-2 timestamp:2023-08-10*\", \"groupby_fields\": [], \"aggregation_function\": \"\", \"aggregation_field\": \"\", \"viz\": \"stream\", \"start\": \"2023-08-10T00:00:00\", \"end\": \"2023-08-10T23:59:59\"}", "sample": "- resource.type:k8s_container timestamp:2023-08-10T04:02:48.597348621Z resource.labels.container_name:envoy severity:ERROR resource.labels.location:us-west1 resource.labels.project_id:fw-ai-cp-prod labels.k8s-pod/app_kubernetes_io/instance:dev-zchenyu resource.labels.cluster_name:control-plane-2\n- labels.k8s-pod/app_kubernetes_io/name:gateway logName:projects/fw-ai-cp-prod/logs/stderr timestamp:2023-08-10T04:02:48.597346551Z insertId:b112pjk16svv5y6j labels.k8s-pod/pod-template-hash:69fb9f646f labels.k8s-pod/app_kubernetes_io/instance:dev-zchenyu resource.labels.cluster_name:control-plane-2 textPayload:\"[2023-08-10 04:02:48.596][1][debug][http] [source/common/http/conn_manager_impl.cc:1530] [C2906][S6888639257194654731] closing connection due to connection close header\"\n- insertId:snxfuubocikm1yzf labels.k8s-pod/app_kubernetes_io/instance:dev-zchenyu timestamp:2023-08-10T04:02:48.597344491Z resource.labels.location:us-west1 resource.labels.namespace_name:default labels.k8s-pod/pod-template-hash:69fb9f646f logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.container_name:envoy\n- logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.location:us-west1 timestamp:2023-08-10T04:02:48.597342382Z labels.k8s-pod/pod-template-hash:69fb9f646f receiveTimestamp:2023-08-10T04:02:49.668675099Z resource.labels.cluster_name:control-plane-2 resource.type:k8s_container labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q\n- resource.labels.namespace_name:default resource.labels.container_name:envoy severity:ERROR textPayload:\"[2023-08-10 04:02:48.596][1][debug][http] [source/common/http/conn_manager_impl.cc:955] [C2906][S6888639257194654731] request end stream\" receiveTimestamp:2023-08-10T04:02:49.668675099Z insertId:o3apjc8ck74zl6ee resource.labels.pod_name:gateway-dev-zchenyu-69fb9f646f-7pw2t timestamp:2023-08-10T04:02:48.597340262Z\n- logName:projects/fw-ai-cp-prod/logs/stderr jsonPayload:{} resource.type:k8s_container labels.k8s-pod/pod-template-hash:69fb9f646f resource.labels.cluster_name:control-plane-2 resource.labels.container_name:envoy receiveTimestamp:2023-08-10T04:02:49.668675099Z resource.labels.pod_name:gateway-dev-zchenyu-69fb9f646f-7pw2t\n- labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q receiveTimestamp:2023-08-10T04:02:49.668675099Z labels.k8s-pod/app_kubernetes_io/instance:dev-zchenyu resource.labels.namespace_name:default resource.labels.cluster_name:control-plane-2 timestamp:2023-08-10T04:02:48.597336091Z resource.labels.container_name:envoy resource.labels.pod_name:gateway-dev-zchenyu-69fb9f646f-7pw2t\n- severity:ERROR resource.labels.namespace_name:default resource.labels.location:us-west1 receiveTimestamp:2023-08-10T04:02:49.668675099Z timestamp:2023-08-10T04:02:48.597333642Z labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q resource.labels.container_name:envoy labels.k8s-pod/pod-template-hash:69fb9f646f\n- resource.labels.project_id:fw-ai-cp-prod resource.labels.pod_name:gateway-dev-zchenyu-69fb9f646f-7pw2t timestamp:2023-08-10T04:02:48.597331451Z labels.k8s-pod/app_kubernetes_io/instance:dev-zchenyu logName:projects/fw-ai-cp-prod/logs/stderr receiveTimestamp:2023-08-10T04:02:49.668675099Z resource.labels.container_name:envoy labels.k8s-pod/pod-template-hash:69fb9f646f\n- resource.labels.container_name:envoy labels.k8s-pod/pod-template-hash:69fb9f646f resource.labels.location:us-west1 labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q resource.labels.cluster_name:control-plane-2 resource.type:k8s_container severity:ERROR resource.labels.project_id:fw-ai-cp-prod"}
{"query": "Search for logs with error severity related to the gateway app in us-west1 location within the past day.", "request": "{\"query_str\": \"severity:ERROR labels.k8s-pod/app_kubernetes_io/name:gateway resource.labels.location:us-west1\", \"groupby_fields\": [], \"aggregation_function\": \"\", \"aggregation_field\": \"\", \"viz\": \"stream\", \"start\": \"now-1d\", \"end\": \"now\"}", "sample": "- textPayload:\"':path', '/ready'\" resource.type:k8s_container resource.labels.pod_name:gateway-dev-zchenyu-69fb9f646f-7pw2t labels.k8s-pod/pod-template-hash:69fb9f646f labels.k8s-pod/app_kubernetes_io/instance:dev-zchenyu labels.k8s-pod/app_kubernetes_io/name:gateway resource.labels.location:us-west1 severity:ERROR\n- resource.type:k8s_container labels.k8s-pod/app_kubernetes_io/name:gateway resource.labels.pod_name:gateway-dev-zchenyu-69fb9f646f-7pw2t labels.k8s-pod/pod-template-hash:69fb9f646f severity:ERROR receiveTimestamp:2023-08-10T04:02:49.668675099Z timestamp:2023-08-10T04:02:48.597325071Z resource.labels.project_id:fw-ai-cp-prod\n- labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q insertId:bfv066b9g3mm62bj logName:projects/fw-ai-cp-prod/logs/stderr labels.k8s-pod/app_kubernetes_io/instance:dev-zchenyu resource.labels.cluster_name:control-plane-2 resource.labels.location:us-west1 labels.k8s-pod/pod-template-hash:69fb9f646f textPayload:\"[2023-08-10 04:02:48.596][1][debug][http] [source/common/http/conn_manager_impl.cc:972] [C2906][S6888639257194654731] request headers complete (end_stream=true):\"\n- labels.k8s-pod/app_kubernetes_io/instance:dev-zchenyu insertId:spvjcpzt8rskeqnz resource.labels.location:us-west1 resource.labels.container_name:envoy labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q labels.k8s-pod/pod-template-hash:69fb9f646f resource.labels.namespace_name:default labels.k8s-pod/app_kubernetes_io/name:gateway\n- logName:projects/fw-ai-cp-prod/logs/stderr labels.k8s-pod/app_kubernetes_io/instance:dev-zchenyu resource.labels.namespace_name:default timestamp:2023-08-10T04:02:48.597318051Z receiveTimestamp:2023-08-10T04:02:49.668675099Z resource.labels.container_name:envoy resource.labels.location:us-west1 resource.labels.project_id:fw-ai-cp-prod\n- resource.labels.location:us-west1 labels.k8s-pod/app_kubernetes_io/instance:dev-zchenyu resource.labels.project_id:fw-ai-cp-prod logName:projects/fw-ai-cp-prod/logs/stderr insertId:an35f9uycafgvoxt textPayload:\"[2023-08-10 04:02:48.596][1][debug][connection] [source/common/network/connection_impl.cc:139] [C2905] closing data_to_write=243 type=0\" labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q timestamp:2023-08-10T04:02:48.597315911Z\n- logName:projects/fw-ai-cp-prod/logs/stderr labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q severity:ERROR timestamp:2023-08-10T04:02:48.597313742Z resource.labels.pod_name:gateway-dev-zchenyu-69fb9f646f-7pw2t insertId:zkt2ugyfsfgpmnjq labels.k8s-pod/pod-template-hash:69fb9f646f labels.k8s-pod/app_kubernetes_io/instance:dev-zchenyu\n- jsonPayload:{} labels.k8s-pod/app_kubernetes_io/name:gateway labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q resource.labels.cluster_name:control-plane-2 labels.k8s-pod/app_kubernetes_io/instance:dev-zchenyu resource.labels.pod_name:gateway-dev-zchenyu-69fb9f646f-7pw2t resource.type:k8s_container resource.labels.project_id:fw-ai-cp-prod\n- resource.labels.project_id:fw-ai-cp-prod resource.labels.container_name:envoy logName:projects/fw-ai-cp-prod/logs/stderr severity:ERROR resource.labels.pod_name:gateway-dev-zchenyu-69fb9f646f-7pw2t resource.labels.location:us-west1 labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q resource.labels.cluster_name:control-plane-2\n- resource.labels.project_id:fw-ai-cp-prod timestamp:2023-08-10T04:02:48.597307562Z labels.k8s-pod/app_kubernetes_io/name:gateway insertId:gsvu92f8ejmrh1hc resource.type:k8s_container labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.location:us-west1"}
{"query": "Display a sunburst chart showing the count of error logs for containers in the default namespace in control-plane-2 cluster within the last two hours.", "request": "{\"query_str\": \"severity:ERROR resource.labels.namespace_name:default resource.labels.cluster_name:control-plane-2\", \"groupby_fields\": [{\"path\":\"resource.labels.container_name\", \"limit\":10, \"order\":\"top\"}], \"aggregation_function\": \"count\", \"aggregation_field\": \"count\", \"viz\": \"sunburst\", \"start\": \"now-2h\", \"end\": \"now\"}", "sample": "- resource.labels.namespace_name:default resource.labels.pod_name:gateway-dev-zchenyu-69fb9f646f-7pw2t labels.k8s-pod/app_kubernetes_io/instance:dev-zchenyu resource.labels.cluster_name:control-plane-2 severity:ERROR logName:projects/fw-ai-cp-prod/logs/stderr labels.k8s-pod/pod-template-hash:69fb9f646f resource.labels.container_name:envoy\n- insertId:p1h4f6c983s6xmox timestamp:2023-08-10T04:02:48.597283931Z receiveTimestamp:2023-08-10T04:02:49.668675099Z resource.labels.project_id:fw-ai-cp-prod resource.labels.cluster_name:control-plane-2 labels.k8s-pod/app_kubernetes_io/name:gateway labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q resource.labels.location:us-west1\n- resource.labels.container_name:envoy timestamp:2023-08-10T04:02:48.597281822Z insertId:1e1ci1unq3rebywe textPayload:\"'cache-control', 'no-cache, max-age=0'\" receiveTimestamp:2023-08-10T04:02:49.668675099Z resource.labels.pod_name:gateway-dev-zchenyu-69fb9f646f-7pw2t resource.labels.namespace_name:default logName:projects/fw-ai-cp-prod/logs/stderr\n- textPayload:\"'content-type', 'text/plain; charset=UTF-8'\" resource.labels.namespace_name:default resource.type:k8s_container logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.project_id:fw-ai-cp-prod resource.labels.location:us-west1 severity:ERROR labels.k8s-pod/app_kubernetes_io/instance:dev-zchenyu\n- resource.labels.container_name:envoy resource.labels.location:us-west1 labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q receiveTimestamp:2023-08-10T04:02:49.668675099Z insertId:7i42nb4v31g0rzhw resource.labels.cluster_name:control-plane-2 labels.k8s-pod/app_kubernetes_io/name:gateway severity:ERROR\n- timestamp:2023-08-10T04:02:48.597273022Z labels.k8s-pod/app_kubernetes_io/instance:dev-zchenyu receiveTimestamp:2023-08-10T04:02:49.668675099Z labels.k8s-pod/app_kubernetes_io/name:gateway insertId:911ue5n8c2ez1qbh resource.labels.cluster_name:control-plane-2 resource.labels.namespace_name:default textPayload:\"[2023-08-10 04:02:48.596][1][debug][http] [source/common/http/conn_manager_impl.cc:1588] [C2905][S5418680999899212240] encoding headers via codec (end_stream=false):\"\n- receiveTimestamp:2023-08-10T04:02:49.668675099Z resource.labels.container_name:envoy resource.labels.namespace_name:default severity:ERROR resource.labels.project_id:fw-ai-cp-prod labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q textPayload:\"[2023-08-10 04:02:48.596][1][debug][admin] [source/server/admin/admin_filter.cc:85] [C2905][S5418680999899212240] request complete: path: /ready\" logName:projects/fw-ai-cp-prod/logs/stderr\n- resource.labels.container_name:envoy labels.k8s-pod/pod-template-hash:69fb9f646f resource.labels.namespace_name:default resource.labels.cluster_name:control-plane-2 resource.labels.project_id:fw-ai-cp-prod labels.k8s-pod/app_kubernetes_io/instance:dev-zchenyu insertId:mi9rsi6bhooy5g2o textPayload:\"[2023-08-10 04:02:48.596][1][debug][connection] [./source/common/network/connection_impl.h:92] [C2905] current connecting state: false\"\n- severity:ERROR insertId:00dwpu2m0a7mldac resource.labels.container_name:envoy labels.k8s-pod/app_kubernetes_io/name:gateway labels.k8s-pod/pod-template-hash:69fb9f646f resource.labels.cluster_name:control-plane-2 receiveTimestamp:2023-08-10T04:02:49.668675099Z logName:projects/fw-ai-cp-prod/logs/stderr\n- labels.k8s-pod/app_kubernetes_io/instance:dev-zchenyu resource.labels.location:us-west1 resource.labels.container_name:envoy labels.k8s-pod/pod-template-hash:69fb9f646f severity:ERROR jsonPayload:{} receiveTimestamp:2023-08-10T04:02:49.668675099Z labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q"}
{"query": "Retrieve the number of error logs generated by containers from the fw-ai-cp-prod project on August 10, 2023, grouped by pod names.", "request": "{\"query_str\": \"severity:ERROR resource.labels.project_id:fw-ai-cp-prod timestamp:2023-08-10\", \"groupby_fields\": [{\"path\":\"resource.labels.pod_name\", \"limit\":10, \"order\":\"top\"}], \"aggregation_function\": \"count\", \"aggregation_field\": \"count\", \"viz\": \"toplist\", \"start\": \"2023-08-10T00:00:00\", \"end\": \"2023-08-10T23:59:59\"}", "sample": "- resource.labels.project_id:fw-ai-cp-prod textPayload:\"'accept', '*/*'\" resource.type:k8s_container resource.labels.pod_name:gateway-dev-zchenyu-69fb9f646f-7pw2t labels.k8s-pod/app_kubernetes_io/name:gateway receiveTimestamp:2023-08-10T04:02:49.668675099Z labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q labels.k8s-pod/pod-template-hash:69fb9f646f\n- labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q severity:ERROR logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.location:us-west1 resource.labels.project_id:fw-ai-cp-prod timestamp:2023-08-10T04:02:48.597238071Z receiveTimestamp:2023-08-10T04:02:49.668675099Z resource.labels.namespace_name:default\n- labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q resource.labels.namespace_name:default resource.labels.container_name:envoy resource.labels.pod_name:gateway-dev-zchenyu-69fb9f646f-7pw2t insertId:1hzjrtvhjt4rzirm resource.labels.cluster_name:control-plane-2 textPayload:\"':method', 'GET'\" resource.labels.project_id:fw-ai-cp-prod\n- resource.labels.container_name:envoy resource.labels.pod_name:gateway-dev-zchenyu-69fb9f646f-7pw2t resource.labels.project_id:fw-ai-cp-prod logName:projects/fw-ai-cp-prod/logs/stderr severity:ERROR timestamp:2023-08-10T04:02:48.597188082Z resource.labels.location:us-west1 textPayload:\"':authority', '10.5.0.25:1082'\"\n- textPayload:\"[2023-08-10 04:02:48.596][1][debug][http] [source/common/http/conn_manager_impl.cc:972] [C2905][S5418680999899212240] request headers complete (end_stream=true):\" timestamp:2023-08-10T04:02:48.597169131Z resource.labels.namespace_name:default resource.labels.project_id:fw-ai-cp-prod resource.labels.cluster_name:control-plane-2 labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q labels.k8s-pod/app_kubernetes_io/instance:dev-zchenyu severity:ERROR\n- severity:ERROR labels.k8s-pod/app_kubernetes_io/name:gateway resource.type:k8s_container insertId:phk45vyge8tc692a resource.labels.location:us-west1 resource.labels.container_name:envoy resource.labels.project_id:fw-ai-cp-prod receiveTimestamp:2023-08-10T04:02:49.668675099Z\n- resource.labels.cluster_name:control-plane-2 resource.labels.container_name:envoy severity:ERROR labels.k8s-pod/pod-template-hash:69fb9f646f resource.labels.project_id:fw-ai-cp-prod resource.labels.location:us-west1 resource.labels.namespace_name:default receiveTimestamp:2023-08-10T04:02:49.668675099Z\n- receiveTimestamp:2023-08-10T04:02:49.668675099Z labels.k8s-pod/app_kubernetes_io/instance:dev-zchenyu labels.k8s-pod/pod-template-hash:69fb9f646f textPayload:\"[2023-08-10 04:02:48.596][1][debug][conn_handler] [source/extensions/listener_managers/listener_manager/active_tcp_listener.cc:147] [C2905] new connection from 10.5.0.1:35886\" timestamp:2023-08-10T04:02:48.597088451Z severity:ERROR resource.type:k8s_container resource.labels.namespace_name:default\n- labels.k8s-pod/controller-revision-hash:579d67b59 resource.labels.container_name:core-metrics-exporter timestamp:2023-08-10T04:02:48.195975702Z resource.labels.project_id:fw-ai-cp-prod receiveTimestamp:2023-08-10T04:02:50.131019103Z severity:ERROR resource.labels.namespace_name:kube-system labels.k8s-pod/pod-template-generation:5 insertId:f2cy7hmo3ug9avng\n- resource.labels.pod_name:gateway-dev-dzhulgakov-66f55647f4-4c6p8 receiveTimestamp:2023-08-10T04:02:48.779804393Z textPayload:\"[2023-08-10 04:02:48.078][1][debug][main] [source/server/server.cc:265] flushing stats\" resource.labels.project_id:fw-ai-cp-prod labels.k8s-pod/pod-template-hash:66f55647f4 labels.k8s-pod/app_kubernetes_io/name:gateway resource.type:k8s_container resource.labels.namespace_name:default"}
{"query": "Get me a toplist of the unique IP addresses causing the most errors in containers running on project fw-ai-cp-prod in us-west1 in control-plane-2 over the last 72 hours.", "request": "{\"query_str\": \"severity:ERROR resource.labels.project_id:fw-ai-cp-prod resource.labels.location:us-west1 resource.labels.cluster_name:control-plane-2\", \"groupby_fields\": [{\"path\":\"protoPayload.requestMetadata.callerIp\", \"limit\":10, \"order\":\"top\"}], \"aggregation_function\": \"count_unique\", \"aggregation_field\": \"protoPayload.requestMetadata.callerIp\", \"viz\": \"toplist\", \"start\": \"now-72h\", \"end\": \"now\"}", "sample": "- labels.k8s-pod/k8s-app:gke-metrics-agent labels.k8s-pod/component:gke-metrics-agent labels.k8s-pod/controller-revision-hash:579d67b59 labels.k8s-pod/pod-template-generation:5 textPayload:\"2023-08-10T04:02:47.996Z\terror\tlogging/logging.go:16\tNodeCollector: Failed to export metrics\t{\"kind\": \"receiver\", \"name\": \"kubenode\", \"error\": \"rpc error: code = PermissionDenied desc = Permission monitoring.timeSeries.create denied (or the resource may not exist).\", \"node\": \"gke-control-plane-2-gateway-pool-382c7a95-oo3q\"}\" resource.type:k8s_container resource.labels.pod_name:gke-metrics-agent-f94kt resource.labels.project_id:fw-ai-cp-prod resource.labels.cluster_name:control-plane-2\n- operation.id:960e9a27-895b-4d2c-abe4-832ff4d3ca09 resource.type:k8s_cluster protoPayload.requestMetadata.callerIp:172.16.0.3 operation.producer:k8s.io operation.last:True operation.first:True resource.labels.cluster_name:inference-1 protoPayload.methodName:io.k8s.coordination.v1.leases.update protoPayload.authenticationInfo.principalEmail:system:cloud-controller-manager resource.labels.project_id:fw-ai-cp-prod timestamp:2023-08-10T04:02:47.892776Z protoPayload.resourceName:coordination.k8s.io/v1/namespaces/kube-system/leases/cloud-controller-manager\n- protoPayload.request.name:projects/fw-ai-cp-prod timestamp:2023-08-10T04:02:47.839278595Z protoPayload.authorizationInfo[0].resource:331150806335 protoPayload.authenticationInfo.serviceAccountDelegationInfo[0].firstPartyPrincipal.principalEmail:service-331150806335@compute-system.iam.gserviceaccount.com protoPayload.requestMetadata.callerNetwork://compute.googleapis.com/projects/fw-ai-cp-prod/global/networks/__unknown__ insertId:1xns3szf1ya33o resource.labels.project_id:fw-ai-cp-prod resource.labels.method:google.monitoring.v3.MetricService.CreateServiceTimeSeries protoPayload.requestMetadata.requestAttributes.time:2023-08-10T04:02:47.993782773Z protoPayload.serviceName:monitoring.googleapis.com protoPayload.request.@type:type.googleapis.com/google.monitoring.v3.CreateTimeSeriesRequest resource.type:audited_resource protoPayload.authenticationInfo.principalSubject:serviceAccount:fireworks-control-plane@fw-ai-cp-prod.iam.gserviceaccount.com protoPayload.authorizationInfo[0].permission:monitoring.timeSeries.create\n- protoPayload.methodName:io.k8s.core.v1.configmaps.update insertId:80546193-cadd-476f-ab79-231af5f84d67 protoPayload.authorizationInfo[0].resource:core/v1/namespaces/kube-system/configmaps/clustermetrics timestamp:2023-08-10T04:02:47.759109Z protoPayload.status.code:0 resource.labels.project_id:fw-ai-cp-prod receiveTimestamp:2023-08-10T04:02:49.243630366Z resource.labels.cluster_name:control-plane-2 labels.authorization.k8s.io/decision:allow protoPayload.authorizationInfo[0].permission:io.k8s.core.v1.configmaps.update protoPayload.serviceName:k8s.io protoPayload.resourceName:core/v1/namespaces/kube-system/configmaps/clustermetrics\n- resource.labels.location:us-west1 resource.labels.container_name:envoy severity:ERROR logName:projects/fw-ai-cp-prod/logs/stderr labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-382c7a95-oo3q timestamp:2023-08-10T04:02:47.482477369Z resource.labels.namespace_name:default labels.k8s-pod/app_kubernetes_io/name:gateway\n- receiveTimestamp:2023-08-10T04:02:50.229956088Z textPayload:\"[2023-08-10 04:02:47.480][1][debug][upstream] [source/extensions/clusters/logical_dns/logical_dns_cluster.cc:108] starting async DNS resolution for 127.0.0.1\" resource.labels.location:us-west1 resource.labels.cluster_name:control-plane-2 labels.k8s-pod/pod-template-hash:77f9d969b4 resource.labels.pod_name:gateway-preview-77f9d969b4-xfwx2 resource.labels.project_id:fw-ai-cp-prod labels.k8s-pod/app_kubernetes_io/name:gateway\n- labels.authorization.k8s.io/reason:\"RBAC: allowed by ClusterRoleBinding \"system:gke-common-webhooks\" of ClusterRole \"system:gke-common-webhooks\" to User \"system:gke-common-webhooks\"\" protoPayload.authorizationInfo[0].permission:io.k8s.coordination.v1.leases.update operation.id:b3915c1c-8547-470f-b770-0de7ced87d33 protoPayload.authorizationInfo[0].granted:True protoPayload.status.code:0 labels.authorization.k8s.io/decision:allow protoPayload.requestMetadata.callerSuppliedUserAgent:\"gke-common-webhooks/v0.0.0 (linux/amd64) kubernetes/$Format\" resource.labels.location:us-west1 protoPayload.resourceName:coordination.k8s.io/v1/namespaces/kube-system/leases/gke-common-webhook-lock protoPayload.methodName:io.k8s.coordination.v1.leases.update protoPayload.serviceName:k8s.io protoPayload.@type:type.googleapis.com/google.cloud.audit.AuditLog\n- receiveTimestamp:2023-08-10T04:02:48.828916456Z operation.first:True protoPayload.requestMetadata.callerIp:172.16.0.38 protoPayload.resourceName:coordination.k8s.io/v1/namespaces/kube-system/leases/cloud-controller-manager resource.type:k8s_cluster protoPayload.status.code:0 resource.labels.location:us-west1 protoPayload.authenticationInfo.principalEmail:system:cloud-controller-manager operation.id:5c9483d3-f7fe-44c4-8885-87d56577ec93 protoPayload.requestMetadata.callerSuppliedUserAgent:\"cloud-controller-manager/v1.26.4 (linux/amd64) kubernetes/ab1c709/leader-election\" operation.last:True protoPayload.methodName:io.k8s.coordination.v1.leases.update\n- resource.labels.project_id:fw-ai-cp-prod labels.k8s-pod/app_kubernetes_io/instance:dev-zchenyu severity:ERROR labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q resource.labels.cluster_name:control-plane-2 textPayload:\"[2023-08-10 04:02:47.148][1][debug][upstream] [source/extensions/clusters/logical_dns/logical_dns_cluster.cc:167] DNS refresh rate reset for 127.0.0.1, refresh rate 5000 ms\" insertId:uznxfpwzl2dqnlwo labels.k8s-pod/app_kubernetes_io/name:gateway\n- labels.k8s-pod/app_kubernetes_io/name:gateway resource.labels.pod_name:gateway-dev-zchenyu-69fb9f646f-7pw2t insertId:a5gajtnjzuzpcy2v textPayload:\"[2023-08-10 04:02:47.148][1][debug][upstream] [source/extensions/clusters/logical_dns/logical_dns_cluster.cc:116] async DNS resolution complete for 127.0.0.1\" timestamp:2023-08-10T04:02:47.148702992Z resource.type:k8s_container resource.labels.project_id:fw-ai-cp-prod resource.labels.cluster_name:control-plane-2"}
{"query": "Find a scatterplot of error logs mapped according to the count and principalEmail, grouped by different services associated with the fw-ai-cp-prod project on August 10, 2023.", "request": "{\"query_str\": \"severity:ERROR resource.labels.project_id:fw-ai-cp-prod\", \"groupby_fields\": [{\"path\": \"protoPayload.authenticationInfo.principalEmail\", \"limit\": 10, \"order\": \"top\"}], \"aggregation_function\": \"count\", \"aggregation_field\": \"count\", \"viz\": \"scatterplot\", \"start\": \"2023-08-10T00:00:00\", \"end\": \"2023-08-10T23:59:59\"}", "sample": "- jsonPayload.connection.src_port:443 resource.labels.project_id:fw-ai-cp-prod jsonPayload.dest_instance.project_id:fw-ai-cp-prod jsonPayload.dest_instance.zone:us-central1-a resource.labels.location:us-central1-a jsonPayload.connection.dest_ip:10.0.0.9 resource.labels.subnetwork_name:inference-us-central1 logName:projects/fw-ai-cp-prod/logs/compute.googleapis.com%2Fvpc_flows jsonPayload.packets_sent:9000 jsonPayload.dest_gke_details.cluster.cluster_location:us-central1-a jsonPayload.dest_instance.region:us-central1 receiveTimestamp:2023-08-10T04:02:47.147981657Z jsonPayload.bytes_sent:4773000 timestamp:2023-08-10T04:02:47.147981657Z\n- severity:ERROR labels.k8s-pod/app_kubernetes_io/name:gateway logName:projects/fw-ai-cp-prod/logs/stderr resource.type:k8s_container timestamp:2023-08-10T04:02:47.134088694Z labels.k8s-pod/app_kubernetes_io/instance:dev-zchenyu resource.labels.pod_name:gateway-dev-zchenyu-69fb9f646f-7pw2t receiveTimestamp:2023-08-10T04:02:49.668675099Z\n- receiveTimestamp:2023-08-10T04:02:49.668675099Z resource.labels.cluster_name:control-plane-2 severity:ERROR resource.labels.project_id:fw-ai-cp-prod resource.labels.pod_name:gateway-dev-zchenyu-69fb9f646f-7pw2t resource.labels.namespace_name:default logName:projects/fw-ai-cp-prod/logs/stderr resource.type:k8s_container\n- protoPayload.requestMetadata.callerIp:10.248.1.4 operation.producer:k8s.io protoPayload.authorizationInfo[0].permission:io.k8s.coordination.v1.leases.update protoPayload.authorizationInfo[0].granted:True protoPayload.authenticationInfo.principalEmail:system:serviceaccount:knative-serving:controller resource.labels.location:us-central1-a protoPayload.requestMetadata.callerSuppliedUserAgent:\"controller/v0.0.0 (linux/amd64) kubernetes/$Format\" protoPayload.methodName:io.k8s.coordination.v1.leases.update operation.last:True resource.labels.cluster_name:inference-1 protoPayload.status.code:0 receiveTimestamp:2023-08-10T04:02:48.496875912Z\n- resource.labels.location:us-central1-a protoPayload.authorizationInfo[0].granted:True protoPayload.resourceName:core/v1/namespaces/kube-system/configmaps/gke-common-webhook-heartbeat protoPayload.authorizationInfo[0].permission:io.k8s.core.v1.configmaps.patch protoPayload.authenticationInfo.principalEmail:system:gke-common-webhooks operation.last:True operation.first:True operation.producer:k8s.io protoPayload.serviceName:k8s.io resource.labels.project_id:fw-ai-cp-prod protoPayload.requestMetadata.callerSuppliedUserAgent:\"gke-common-webhooks/v0.0.0 (linux/amd64) kubernetes/$Format\" protoPayload.methodName:io.k8s.core.v1.configmaps.patch\n- operation.last:True timestamp:2023-08-10T04:02:46.449779Z protoPayload.authorizationInfo[0].granted:True protoPayload.status.code:0 resource.labels.cluster_name:control-plane-2 operation.producer:k8s.io protoPayload.methodName:io.k8s.coordination.v1.leases.update protoPayload.requestMetadata.callerSuppliedUserAgent:\"gcp-controller-manager/v0.0.0 (linux/amd64) kubernetes/$Format/leader-election\" protoPayload.authorizationInfo[0].resource:coordination.k8s.io/v1/namespaces/kube-system/leases/gcp-controller-manager protoPayload.authorizationInfo[0].permission:io.k8s.coordination.v1.leases.update labels.authorization.k8s.io/reason:\"RBAC: allowed by ClusterRoleBinding \"system:gcp-controller-manager\" of ClusterRole \"system:gcp-controller-manager\" to User \"system:gcp-controller-manager\"\" resource.type:k8s_cluster\n- labels.authorization.k8s.io/decision:allow protoPayload.authorizationInfo[0].granted:True receiveTimestamp:2023-08-10T04:02:46.705681071Z protoPayload.requestMetadata.callerIp:172.16.0.3 resource.type:k8s_cluster operation.first:True logName:projects/fw-ai-cp-prod/logs/cloudaudit.googleapis.com%2Factivity resource.labels.project_id:fw-ai-cp-prod protoPayload.serviceName:k8s.io resource.labels.location:us-central1-a protoPayload.methodName:io.k8s.coordination.v1.leases.update protoPayload.authorizationInfo[0].permission:io.k8s.coordination.v1.leases.update\n- labels.k8s-pod/pod-template-hash:77f9d969b4 logName:projects/fw-ai-cp-prod/logs/stderr labels.k8s-pod/app_kubernetes_io/name:gateway resource.labels.container_name:envoy resource.labels.location:us-west1 resource.labels.pod_name:gateway-preview-77f9d969b4-xfwx2 textPayload:\"[2023-08-10 04:02:46.329][1][debug][main] [source/server/server.cc:265] flushing stats\" resource.type:k8s_container\n- resource.labels.project_id:fw-ai-cp-prod protoPayload.methodName:io.k8s.coordination.v1.leases.update protoPayload.authorizationInfo[0].permission:io.k8s.coordination.v1.leases.update operation.first:True resource.labels.cluster_name:control-plane-2 timestamp:2023-08-10T04:02:46.114071Z protoPayload.status.code:0 protoPayload.requestMetadata.callerIp:172.16.0.38 operation.producer:k8s.io labels.authorization.k8s.io/reason:\"RBAC: allowed by RoleBinding \"system:gke-ccm-migration-leader-election/kube-system\" of Role \"system:gke-ccm-migration-leader-election\" to User \"system:cloud-controller-manager\"\" labels.authorization.k8s.io/decision:allow protoPayload.@type:type.googleapis.com/google.cloud.audit.AuditLog\n- protoPayload.authenticationInfo.principalEmail:system:snapshot-controller protoPayload.authorizationInfo[0].permission:io.k8s.coordination.v1.leases.update protoPayload.authorizationInfo[0].granted:True protoPayload.status.code:0 protoPayload.serviceName:k8s.io receiveTimestamp:2023-08-10T04:02:47.547400153Z labels.authorization.k8s.io/reason:\"RBAC: allowed by RoleBinding \"snapshot-controller-leaderelection/kube-system\" of Role \"snapshot-controller-leaderelection\" to User \"system:snapshot-controller\"\" operation.id:eabbc28d-7c5f-4fd8-90e9-8086085b80d7 resource.labels.project_id:fw-ai-cp-prod operation.last:True labels.authorization.k8s.io/decision:allow logName:projects/fw-ai-cp-prod/logs/cloudaudit.googleapis.com%2Factivity"}
{"query": "Show a timeseries visualization of logs marked as error related to coordination leases updates from the principalEmail system:cluster-autoscaler within the last day.", "request": "{\"query_str\": \"protoPayload.authorizationInfo[0].permission:io.k8s.coordination.v1.leases.update protoPayload.status.code:0 protoPayload.authenticationInfo.principalEmail:system:cluster-autoscaler\", \"groupby_fields\": [], \"aggregation_function\": \"\", \"aggregation_field\": \"\", \"viz\": \"timeseries\", \"start\": \"now-1d\", \"end\": \"now\"}", "sample": "- protoPayload.methodName:io.k8s.coordination.v1.leases.update operation.producer:k8s.io protoPayload.requestMetadata.callerSuppliedUserAgent:\"kube-apiserver/v1.26.5 (linux/amd64) kubernetes/4eb5737\" protoPayload.resourceName:coordination.k8s.io/v1/namespaces/kube-system/leases/kube-apiserver-r322wxkholbdzus2euq64tjfhe resource.type:k8s_cluster protoPayload.@type:type.googleapis.com/google.cloud.audit.AuditLog protoPayload.authenticationInfo.principalEmail:system:apiserver protoPayload.authorizationInfo[0].resource:coordination.k8s.io/v1/namespaces/kube-system/leases/kube-apiserver-r322wxkholbdzus2euq64tjfhe resource.labels.location:us-central1-a operation.first:True operation.id:441d3e21-3bd0-42f9-a7fa-a69a3e3dc670 receiveTimestamp:2023-08-10T04:02:46.908054291Z\n- protoPayload.authorizationInfo[0].permission:io.k8s.coordination.v1.leases.update protoPayload.requestMetadata.callerSuppliedUserAgent:\"managed-certificate-controller/v0.0.0 (linux/amd64) kubernetes/$Format\" timestamp:2023-08-10T04:02:45.952846Z protoPayload.serviceName:k8s.io protoPayload.methodName:io.k8s.coordination.v1.leases.update protoPayload.authorizationInfo[0].granted:True labels.authorization.k8s.io/decision:allow protoPayload.@type:type.googleapis.com/google.cloud.audit.AuditLog logName:projects/fw-ai-cp-prod/logs/cloudaudit.googleapis.com%2Factivity protoPayload.authorizationInfo[0].resource:coordination.k8s.io/v1/namespaces/kube-system/leases/managed-certificate-controller labels.authorization.k8s.io/reason:\"RBAC: allowed by ClusterRoleBinding \"system:managed-certificate-controller\" of ClusterRole \"system:managed-certificate-controller\" to User \"system:managed-certificate-controller\"\" operation.producer:k8s.io\n- resource.labels.location:us-central1-a resource.type:k8s_cluster resource.labels.project_id:fw-ai-cp-prod operation.producer:k8s.io protoPayload.@type:type.googleapis.com/google.cloud.audit.AuditLog labels.authorization.k8s.io/reason:\"RBAC: allowed by ClusterRoleBinding \"system:gke-common-webhooks\" of ClusterRole \"system:gke-common-webhooks\" to User \"system:gke-common-webhooks\"\" protoPayload.serviceName:k8s.io protoPayload.status.code:0 protoPayload.resourceName:coordination.k8s.io/v1/namespaces/kube-system/leases/gke-common-webhook-lock timestamp:2023-08-10T04:02:45.886889Z protoPayload.methodName:io.k8s.coordination.v1.leases.update protoPayload.authorizationInfo[0].resource:coordination.k8s.io/v1/namespaces/kube-system/leases/gke-common-webhook-lock\n- protoPayload.authorizationInfo[0].resource:coordination.k8s.io/v1/namespaces/kube-node-lease/leases/gke-control-plane-2-gateway-pool-ac2cab1a-8d6q protoPayload.authorizationInfo[0].permission:io.k8s.coordination.v1.leases.update operation.id:8e6cc438-38cc-417d-8a41-2a5952a1b1ac operation.producer:k8s.io operation.first:True protoPayload.resourceName:coordination.k8s.io/v1/namespaces/kube-node-lease/leases/gke-control-plane-2-gateway-pool-ac2cab1a-8d6q operation.last:True protoPayload.methodName:io.k8s.coordination.v1.leases.update labels.authorization.k8s.io/decision:allow protoPayload.@type:type.googleapis.com/google.cloud.audit.AuditLog protoPayload.requestMetadata.callerSuppliedUserAgent:\"kubelet/v1.26.5 (linux/amd64) kubernetes/4eb5737\" insertId:8e6cc438-38cc-417d-8a41-2a5952a1b1ac\n- labels.authorization.k8s.io/decision:allow operation.id:bd9ddc58-8ab6-45fb-8893-8b603120e1cb resource.labels.location:us-west1 protoPayload.status.code:0 operation.last:True timestamp:2023-08-10T04:02:45.833185Z protoPayload.authorizationInfo[0].permission:io.k8s.coordination.v1.leases.update resource.labels.project_id:fw-ai-cp-prod logName:projects/fw-ai-cp-prod/logs/cloudaudit.googleapis.com%2Factivity protoPayload.authorizationInfo[0].granted:True labels.authorization.k8s.io/reason:\"RBAC: allowed by ClusterRoleBinding \"system:kube-scheduler\" of ClusterRole \"system:kube-scheduler\" to User \"system:kube-scheduler\"\" protoPayload.requestMetadata.callerIp:172.16.0.40\n- protoPayload.requestMetadata.callerIp:172.16.0.38 resource.type:k8s_cluster protoPayload.authorizationInfo[0].permission:io.k8s.core.v1.configmaps.update operation.first:True protoPayload.authenticationInfo.principalEmail:system:clustermetrics protoPayload.methodName:io.k8s.core.v1.configmaps.update insertId:15e58ed4-f5a1-46ff-8ef0-8aece2b45335 protoPayload.resourceName:core/v1/namespaces/kube-system/configmaps/clustermetrics operation.producer:k8s.io labels.authorization.k8s.io/reason:\"RBAC: allowed by ClusterRoleBinding \"system:clustermetrics\" of ClusterRole \"system:clustermetrics\" to User \"system:clustermetrics\"\" receiveTimestamp:2023-08-10T04:02:47.027023880Z protoPayload.serviceName:k8s.io\n- protoPayload.authenticationInfo.principalEmail:system:cluster-autoscaler protoPayload.requestMetadata.callerSuppliedUserAgent:\"cluster-autoscaler/v0.0.0 (linux/amd64) kubernetes/$Format\" resource.labels.project_id:fw-ai-cp-prod resource.labels.location:us-central1-a protoPayload.requestMetadata.callerIp:172.16.0.3 resource.labels.cluster_name:inference-1 receiveTimestamp:2023-08-10T04:02:46.365891727Z protoPayload.authorizationInfo[0].permission:io.k8s.coordination.v1.leases.update operation.last:True protoPayload.authorizationInfo[0].granted:True operation.producer:k8s.io protoPayload.status.code:0\n- insertId:c9eam8dub9olmtez resource.labels.cluster_name:control-plane-2 timestamp:2023-08-10T04:02:45.493921683Z resource.type:k8s_container labels.compute.googleapis.com/resource_name:gke-control-plane-2-default-pool-69263587-gcwj resource.labels.container_name:core-metrics-exporter resource.labels.pod_name:gke-metrics-agent-9xbd8 resource.labels.location:us-west1 labels.k8s-pod/pod-template-generation:5\n- receiveTimestamp:2023-08-10T04:02:46.601409499Z protoPayload.authorizationInfo[0].resource:coordination.k8s.io/v1/namespaces/kube-system/leases/ingress-gce-lock protoPayload.authorizationInfo[0].permission:io.k8s.coordination.v1.leases.update protoPayload.resourceName:coordination.k8s.io/v1/namespaces/kube-system/leases/ingress-gce-lock protoPayload.status.code:0 operation.producer:k8s.io operation.first:True labels.authorization.k8s.io/reason:\"RBAC: allowed by ClusterRoleBinding \"system:glbc-status\" of ClusterRole \"system:glbc-status\" to User \"system:l7-lb-controller\"\" protoPayload.methodName:io.k8s.coordination.v1.leases.update logName:projects/fw-ai-cp-prod/logs/cloudaudit.googleapis.com%2Factivity protoPayload.requestMetadata.callerSuppliedUserAgent:\"glbc/v0.0.0 (linux/amd64) kubernetes/$Format/leader-election\" resource.labels.location:us-central1-a\n- protoPayload.authorizationInfo[0].permission:io.k8s.coordination.v1.leases.update logName:projects/fw-ai-cp-prod/logs/cloudaudit.googleapis.com%2Factivity operation.producer:k8s.io protoPayload.serviceName:k8s.io resource.labels.project_id:fw-ai-cp-prod labels.authorization.k8s.io/decision:allow operation.last:True protoPayload.methodName:io.k8s.coordination.v1.leases.update protoPayload.@type:type.googleapis.com/google.cloud.audit.AuditLog protoPayload.requestMetadata.callerIp:172.16.0.3 protoPayload.requestMetadata.callerSuppliedUserAgent:\"vpa-recommender/v0.0.0 (linux/amd64) kubernetes/$Format\" receiveTimestamp:2023-08-10T04:02:45.926066123Z"}
{"query": "Retrieve a stream of logs with error severity for the service emailer on a host with an internal Google Cloud fetch instance.", "request": "{\"query_str\": \"severity:ERROR service:emailer\", \"groupby_fields\": [], \"aggregation_function\": \"\", \"aggregation_field\": \"\", \"viz\": \"stream\", \"start\": \"now-1h\", \"end\": \"now\"}", "sample": "- insertId:c75331c5-6aac-480a-b40e-e741d726fb1a protoPayload.response.metadata.managedFields[0].time:2023-08-10T04:02:45Z protoPayload.authorizationInfo[0].resource:core/v1/namespaces/kube-system/endpoints/vpa-recommender resource.type:k8s_cluster logName:projects/fw-ai-cp-prod/logs/cloudaudit.googleapis.com%2Factivity protoPayload.request.metadata.managedFields[0].manager:vpa-recommender protoPayload.request.@type:core.k8s.io/v1.Endpoints resource.labels.location:us-central1-a resource.labels.project_id:fw-ai-cp-prod protoPayload.request.kind:Endpoints protoPayload.request.metadata.managedFields[0].apiVersion:v1 protoPayload.authorizationInfo[0].granted:True protoPayload.response.metadata.managedFields[0].operation:Update protoPayload.request.metadata.creationTimestamp:2023-07-21T22:16:55Z protoPayload.resourceName:core/v1/namespaces/kube-system/endpoints/vpa-recommender protoPayload.request.metadata.managedFields[0].operation:Update operation.producer:k8s.io timestamp:2023-08-10T04:02:45.387092Z protoPayload.serviceName:k8s.io operation.id:c75331c5-6aac-480a-b40e-e741d726fb1a protoPayload.request.metadata.namespace:kube-system protoPayload.request.metadata.managedFields[0].fieldsType:FieldsV1 protoPayload.request.metadata.managedFields[0].fieldsV1.f:\"metadata.f:annotations..:                                           {}\" protoPayload.response.metadata.managedFields[0].fieldsV1.f:\"metadata.f:annotations..:                                          {}\" protoPayload.response.metadata.managedFields[0].fieldsV1.f:\"metadata.f:annotations.f:control-plane.alpha.kubernetes.io/leader: {}\" protoPayload.request.metadata.name:vpa-recommender resource.labels.cluster_name:inference-1 protoPayload.authenticationInfo.principalEmail:system:vpa-recommender\n- resource.labels.location:us-central1-a resource.labels.cluster_name:inference-1 protoPayload.requestMetadata.callerSuppliedUserAgent:\"kube-scheduler/v1.26.5 (linux/amd64) kubernetes/4eb5737/leader-election\" protoPayload.serviceName:k8s.io insertId:e6b90ad9-5017-498c-90f1-795fa8a2210c operation.first:True labels.authorization.k8s.io/reason:\"RBAC: allowed by ClusterRoleBinding \"system:kube-scheduler\" of ClusterRole \"system:kube-scheduler\" to User \"system:kube-scheduler\"\" protoPayload.methodName:io.k8s.coordination.v1.leases.update logName:projects/fw-ai-cp-prod/logs/cloudaudit.googleapis.com%2Factivity operation.id:e6b90ad9-5017-498c-90f1-795fa8a2210c operation.last:True protoPayload.requestMetadata.callerIp:172.16.0.3\n- protoPayload.authenticationInfo.serviceAccountDelegationInfo[0].firstPartyPrincipal.principalEmail:service-331150806335@compute-system.iam.gserviceaccount.com protoPayload.@type:type.googleapis.com/google.cloud.audit.AuditLog timestamp:2023-08-10T04:02:45.306751335Z severity:ERROR protoPayload.resourceName:projects/fw-ai-cp-prod resource.type:audited_resource protoPayload.requestMetadata.callerNetwork://compute.googleapis.com/projects/fw-ai-cp-prod/global/networks/__unknown__ insertId:1hk014kf1em5f3 logName:projects/fw-ai-cp-prod/logs/cloudaudit.googleapis.com%2Fdata_access protoPayload.authorizationInfo[0].resource:331150806335 protoPayload.authenticationInfo.principalEmail:fireworks-control-plane@fw-ai-cp-prod.iam.gserviceaccount.com protoPayload.request.name:projects/fw-ai-cp-prod protoPayload.requestMetadata.callerIp:10.1.0.105 receiveTimestamp:2023-08-10T04:02:45.596664087Z\n- resource.type:k8s_container logName:projects/fw-ai-cp-prod/logs/stderr labels.k8s-pod/controller-revision-hash:579d67b59 resource.labels.pod_name:gke-metrics-agent-f94kt labels.k8s-pod/component:gke-metrics-agent severity:ERROR timestamp:2023-08-10T04:02:45.295641514Z receiveTimestamp:2023-08-10T04:02:50.131019103Z resource.labels.location:us-west1\n- receiveTimestamp:2023-08-10T04:02:50.131019103Z timestamp:2023-08-10T04:02:45.295633167Z labels.k8s-pod/k8s-app:gke-metrics-agent resource.labels.namespace_name:kube-system resource.labels.cluster_name:control-plane-2 resource.labels.container_name:core-metrics-exporter insertId:6gx2cufmsbsjvu9l resource.labels.location:us-west1 resource.type:k8s_container\n- insertId:g1b2rpd6fslof64r resource.labels.project_id:fw-ai-cp-prod timestamp:2023-08-10T04:02:45.295569276Z resource.labels.namespace_name:kube-system resource.type:k8s_container labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-382c7a95-oo3q resource.labels.cluster_name:control-plane-2 logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.location:us-west1\n- resource.type:k8s_cluster resource.labels.location:us-west1 protoPayload.authorizationInfo[0].resource:coordination.k8s.io/v1/namespaces/kube-system/leases/addon-manager protoPayload.authenticationInfo.principalEmail:system:addon-manager logName:projects/fw-ai-cp-prod/logs/cloudaudit.googleapis.com%2Factivity operation.producer:k8s.io protoPayload.authorizationInfo[0].granted:True protoPayload.@type:type.googleapis.com/google.cloud.audit.AuditLog protoPayload.authorizationInfo[0].permission:io.k8s.coordination.v1.leases.update resource.labels.cluster_name:control-plane-2 operation.id:96a7eeb3-9d72-4570-b9c4-0a4b9b1db150 labels.authorization.k8s.io/decision:allow\n- labels.authorization.k8s.io/reason:\"RBAC: allowed by ClusterRoleBinding \"system:kubestore-collector\" of ClusterRole \"system:kubestore-collector\" to User \"system:kubestore-collector\"\" protoPayload.serviceName:k8s.io timestamp:2023-08-10T04:02:45.196324Z protoPayload.resourceName:core/v1/namespaces/kube-system/configmaps/cluster-kubestore protoPayload.authorizationInfo[0].resource:core/v1/namespaces/kube-system/configmaps/cluster-kubestore resource.labels.project_id:fw-ai-cp-prod protoPayload.requestMetadata.callerIp:172.16.0.38 operation.first:True resource.type:k8s_cluster protoPayload.@type:type.googleapis.com/google.cloud.audit.AuditLog protoPayload.methodName:io.k8s.core.v1.configmaps.update protoPayload.authorizationInfo[0].granted:True\n- resource.type:k8s_container textPayload:\"2023-08-10T04:02:45.195Z\terror\tlogging/logging.go:16\tNodeCollector: Failed to export metrics\t{\"kind\": \"receiver\", \"name\": \"kubenode\", \"error\": \"rpc error: code = PermissionDenied desc = Permission monitoring.timeSeries.create denied (or the resource may not exist).\", \"node\": \"gke-control-plane-2-default-pool-69263587-gcwj\"}\" timestamp:2023-08-10T04:02:45.195842355Z labels.k8s-pod/controller-revision-hash:579d67b59 receiveTimestamp:2023-08-10T04:02:45.727532101Z resource.labels.pod_name:gke-metrics-agent-9xbd8 resource.labels.namespace_name:kube-system logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.project_id:fw-ai-cp-prod\n- resource.labels.cluster_name:inference-1 timestamp:2023-08-10T04:02:45.189141Z protoPayload.requestMetadata.callerIp:10.248.1.2 labels.authorization.k8s.io/decision:allow operation.last:True protoPayload.resourceName:coordination.k8s.io/v1/namespaces/knative-serving/leases/autoscaler-bucket-00-of-01 receiveTimestamp:2023-08-10T04:02:45.926066123Z protoPayload.@type:type.googleapis.com/google.cloud.audit.AuditLog protoPayload.serviceName:k8s.io operation.producer:k8s.io resource.labels.project_id:fw-ai-cp-prod protoPayload.authorizationInfo[0].permission:io.k8s.coordination.v1.leases.update"}
{"query": "Identify logs from the fw-ai-cp-prod project that bear the status error, and present a count of these logs grouped by resource type, visualized as a sunburst for August 10, 2023.", "request": "{\"query_str\": \"resource.labels.project_id:fw-ai-cp-prod protoPayload.status.code:7\", \"groupby_fields\": [{\"path\":\"resource.type\", \"limit\":10, \"order\":\"top\"}], \"aggregation_function\": \"count\", \"aggregation_field\": \"count\", \"viz\": \"sunburst\", \"start\": \"2023-08-10T00:00:00\", \"end\": \"2023-08-10T23:59:59\"}", "sample": "- protoPayload.status.code:0 logName:projects/fw-ai-cp-prod/logs/cloudaudit.googleapis.com%2Factivity protoPayload.resourceName:coordination.k8s.io/v1/namespaces/kube-system/leases/cloud-controller-manager operation.first:True protoPayload.@type:type.googleapis.com/google.cloud.audit.AuditLog protoPayload.authorizationInfo[0].resource:coordination.k8s.io/v1/namespaces/kube-system/leases/cloud-controller-manager insertId:96330d9a-bd24-47b5-8fdf-4cde0fd7cb29 labels.authorization.k8s.io/reason:\"RBAC: allowed by ClusterRoleBinding \"system:cloud-controller-manager\" of ClusterRole \"system:cloud-controller-manager\" to User \"system:cloud-controller-manager\"\" protoPayload.requestMetadata.callerSuppliedUserAgent:\"cloud-controller-manager/v1.26.4 (linux/amd64) kubernetes/ab1c709/leader-election\" protoPayload.serviceName:k8s.io resource.type:k8s_cluster labels.authorization.k8s.io/decision:allow\n- resource.labels.project_id:fw-ai-cp-prod protoPayload.requestMetadata.callerSuppliedUserAgent:\"opentelemetry-collector-contrib 1.3.11/1.9.3-gke.2 grpc-go/1.46.0,gzip(gfe)\" severity:ERROR protoPayload.status.message:\"Permission monitoring.timeSeries.create denied (or the resource may not exist).\" protoPayload.requestMetadata.destinationAttributes:{} protoPayload.authorizationInfo[0].resource:331150806335 protoPayload.authenticationInfo.serviceAccountDelegationInfo[0].firstPartyPrincipal.principalEmail:service-331150806335@compute-system.iam.gserviceaccount.com protoPayload.resourceName:projects/fw-ai-cp-prod protoPayload.methodName:google.monitoring.v3.MetricService.CreateServiceTimeSeries protoPayload.serviceName:monitoring.googleapis.com protoPayload.requestMetadata.requestAttributes.time:2023-08-10T04:02:45.293680989Z logName:projects/fw-ai-cp-prod/logs/cloudaudit.googleapis.com%2Fdata_access protoPayload.authenticationInfo.principalSubject:serviceAccount:fireworks-control-plane@fw-ai-cp-prod.iam.gserviceaccount.com protoPayload.requestMetadata.callerIp:10.1.0.8\n- operation.producer:k8s.io operation.last:True resource.type:k8s_cluster resource.labels.project_id:fw-ai-cp-prod protoPayload.authorizationInfo[0].granted:True resource.labels.location:us-west1 resource.labels.cluster_name:control-plane-2 protoPayload.authenticationInfo.principalEmail:system:gke-common-webhooks protoPayload.resourceName:coordination.k8s.io/v1/namespaces/kube-system/leases/gke-common-webhook-lock protoPayload.requestMetadata.callerSuppliedUserAgent:\"gke-common-webhooks/v0.0.0 (linux/amd64) kubernetes/$Format\" protoPayload.methodName:io.k8s.coordination.v1.leases.update operation.id:e7d394e3-5ccb-4668-804d-55814609bc0c\n- protoPayload.methodName:google.monitoring.v3.MetricService.CreateServiceTimeSeries protoPayload.status.code:7 protoPayload.authorizationInfo[0].permission:monitoring.timeSeries.create protoPayload.authenticationInfo.principalEmail:fireworks-control-plane@fw-ai-cp-prod.iam.gserviceaccount.com protoPayload.authenticationInfo.serviceAccountDelegationInfo[0].firstPartyPrincipal.principalEmail:service-331150806335@compute-system.iam.gserviceaccount.com protoPayload.requestMetadata.requestAttributes.auth:{} protoPayload.authorizationInfo[0].resource:331150806335 timestamp:2023-08-10T04:02:45.115364726Z protoPayload.requestMetadata.destinationAttributes:{} protoPayload.status.message:\"Permission monitoring.timeSeries.create denied (or the resource may not exist).\" protoPayload.requestMetadata.callerSuppliedUserAgent:\"opentelemetry-collector-contrib 1.3.11/1.9.3-gke.2 grpc-go/1.46.0,gzip(gfe)\" protoPayload.serviceName:monitoring.googleapis.com insertId:11r0k5yf1efi0t protoPayload.@type:type.googleapis.com/google.cloud.audit.AuditLog\n- insertId:qwpxnjf2lu9f0kz7 labels.k8s-pod/controller-revision-hash:579d67b59 labels.k8s-pod/k8s-app:gke-metrics-agent resource.type:k8s_container resource.labels.container_name:core-metrics-exporter labels.compute.googleapis.com/resource_name:gke-control-plane-2-default-pool-69263587-gcwj labels.k8s-pod/component:gke-metrics-agent severity:ERROR logName:projects/fw-ai-cp-prod/logs/stderr\n- timestamp:2023-08-10T04:02:45.095209713Z resource.labels.namespace_name:kube-system resource.type:k8s_container textPayload:\"2023-08-10T04:02:45.094Z\terror\texporterhelper/queued_retry.go:101\tExporting failed. Dropping data. Try enabling sending_queue to survive temporary failures.\t{\"kind\": \"exporter\", \"name\": \"googlecloud\", \"dropped_items\": 175}\" labels.compute.googleapis.com/resource_name:gke-control-plane-2-default-pool-69263587-gcwj labels.k8s-pod/k8s-app:gke-metrics-agent labels.k8s-pod/controller-revision-hash:579d67b59 resource.labels.cluster_name:control-plane-2 labels.k8s-pod/pod-template-generation:5\n- labels.k8s-pod/controller-revision-hash:579d67b59 severity:ERROR textPayload:\"2023-08-10T04:02:45.094Z\terror\texporterhelper/queued_retry.go:165\tExporting failed. Try enabling retry_on_failure config option.\t{\"kind\": \"exporter\", \"name\": \"googlecloud\", \"error\": \"rpc error: code = PermissionDenied desc = Permission monitoring.timeSeries.create denied (or the resource may not exist).\"}\" resource.labels.namespace_name:kube-system labels.k8s-pod/k8s-app:gke-metrics-agent labels.k8s-pod/pod-template-generation:5 labels.k8s-pod/component:gke-metrics-agent timestamp:2023-08-10T04:02:45.095118535Z resource.labels.pod_name:gke-metrics-agent-9xbd8\n- logName:projects/fw-ai-cp-prod/logs/cloudaudit.googleapis.com%2Factivity operation.id:fea41e3f-7e2a-436d-a69c-2d8815552abd resource.labels.location:us-central1-a protoPayload.resourceName:coordination.k8s.io/v1/namespaces/kube-node-lease/leases/gke-inference-1-system-2-5e33120b-nx78 resource.labels.cluster_name:inference-1 protoPayload.requestMetadata.callerIp:10.0.0.7 protoPayload.authorizationInfo[0].resource:coordination.k8s.io/v1/namespaces/kube-node-lease/leases/gke-inference-1-system-2-5e33120b-nx78 operation.first:True insertId:fea41e3f-7e2a-436d-a69c-2d8815552abd operation.producer:k8s.io protoPayload.authenticationInfo.principalEmail:system:node:gke-inference-1-system-2-5e33120b-nx78 protoPayload.authorizationInfo[0].permission:io.k8s.coordination.v1.leases.update\n- labels.authorization.k8s.io/reason:\"RBAC: allowed by ClusterRoleBinding \"system:clustermetrics\" of ClusterRole \"system:clustermetrics\" to User \"system:clustermetrics\"\" protoPayload.requestMetadata.callerIp:172.16.0.3 protoPayload.authenticationInfo.principalEmail:system:clustermetrics resource.type:k8s_cluster insertId:a61e4865-2c79-4875-a6d5-5d38ed4652c6 resource.labels.project_id:fw-ai-cp-prod protoPayload.serviceName:k8s.io resource.labels.location:us-central1-a timestamp:2023-08-10T04:02:45.031387Z protoPayload.@type:type.googleapis.com/google.cloud.audit.AuditLog protoPayload.resourceName:core/v1/namespaces/kube-system/configmaps/clustermetrics labels.authorization.k8s.io/decision:allow\n- receiveTimestamp:2023-08-10T04:02:45.998853742Z protoPayload.authorizationInfo[0].resourceAttributes:{} resource.labels.method:google.monitoring.v3.MetricService.CreateServiceTimeSeries protoPayload.authenticationInfo.serviceAccountDelegationInfo[0].firstPartyPrincipal.principalEmail:service-331150806335@compute-system.iam.gserviceaccount.com protoPayload.status.message:\"Permission monitoring.timeSeries.create denied (or the resource may not exist).\" protoPayload.requestMetadata.callerNetwork://compute.googleapis.com/projects/fw-ai-cp-prod/global/networks/__unknown__ protoPayload.status.code:7 protoPayload.resourceName:projects/fw-ai-cp-prod protoPayload.serviceName:monitoring.googleapis.com protoPayload.request.name:projects/fw-ai-cp-prod protoPayload.requestMetadata.requestAttributes.time:2023-08-10T04:02:45.194154587Z protoPayload.request.@type:type.googleapis.com/google.monitoring.v3.CreateTimeSeriesRequest protoPayload.@type:type.googleapis.com/google.cloud.audit.AuditLog resource.labels.project_id:fw-ai-cp-prod"}
{"query": "Give an account of logs that detail error events in the Kubernetes namespace labelled as default and are associated with the application labelled as gateway, within the past 24 hours. Present the count of these logs grouped by pod names and display as a treemap.", "request": "{\"query_str\": \"severity:ERROR labels.k8s-pod/app_kubernetes_io/name:gateway resource.labels.namespace_name:default\", \"groupby_fields\": [{\"path\":\"resource.labels.pod_name\", \"limit\":10, \"order\":\"top\"}], \"aggregation_function\": \"count\", \"aggregation_field\": \"count\", \"viz\": \"treemap\", \"start\": \"now-1d\", \"end\": \"now\"}", "sample": "- labels.k8s-pod/app_kubernetes_io/name:gateway logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.namespace_name:default labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-382c7a95-oo3q textPayload:\"[2023-08-10 04:02:45.011][1][debug][conn_handler] [source/extensions/listener_managers/listener_manager/active_stream_listener_base.cc:120] [C14659] adding to cleanup list\" insertId:a0ks441kvmese6tr resource.labels.cluster_name:control-plane-2 labels.k8s-pod/app_kubernetes_io/instance:preview\n- resource.labels.location:us-west1 resource.labels.pod_name:gateway-preview-77f9d969b4-xfwx2 labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-382c7a95-oo3q labels.k8s-pod/app_kubernetes_io/instance:preview timestamp:2023-08-10T04:02:45.012361549Z textPayload:\"[2023-08-10 04:02:45.011][1][debug][connection] [source/common/network/connection_impl.cc:250] [C14659] closing socket: 1\" receiveTimestamp:2023-08-10T04:02:45.184541417Z resource.type:k8s_container\n- resource.labels.cluster_name:control-plane-2 resource.labels.pod_name:gateway-preview-77f9d969b4-xfwx2 textPayload:\"[2023-08-10 04:02:45.011][1][debug][connection] [source/common/network/connection_impl.cc:720] [C14659] write flush complete\" resource.type:k8s_container logName:projects/fw-ai-cp-prod/logs/stderr labels.k8s-pod/pod-template-hash:77f9d969b4 labels.k8s-pod/app_kubernetes_io/instance:preview timestamp:2023-08-10T04:02:45.012356552Z\n- labels.k8s-pod/app_kubernetes_io/instance:preview receiveTimestamp:2023-08-10T04:02:45.184541417Z resource.type:k8s_container resource.labels.namespace_name:default textPayload:\"[2023-08-10 04:02:45.011][1][debug][conn_handler] [source/extensions/listener_managers/listener_manager/active_stream_listener_base.cc:120] [C14658] adding to cleanup list\" labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-382c7a95-oo3q labels.k8s-pod/pod-template-hash:77f9d969b4 labels.k8s-pod/app_kubernetes_io/name:gateway\n- labels.k8s-pod/pod-template-hash:77f9d969b4 labels.k8s-pod/app_kubernetes_io/name:gateway resource.labels.pod_name:gateway-preview-77f9d969b4-xfwx2 labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-382c7a95-oo3q severity:ERROR textPayload:\"[2023-08-10 04:02:45.011][1][debug][connection] [source/common/network/connection_impl.cc:250] [C14658] closing socket: 1\" resource.labels.namespace_name:default logName:projects/fw-ai-cp-prod/logs/stderr\n- logName:projects/fw-ai-cp-prod/logs/stderr labels.k8s-pod/pod-template-hash:77f9d969b4 severity:ERROR resource.labels.project_id:fw-ai-cp-prod resource.type:k8s_container resource.labels.cluster_name:control-plane-2 labels.k8s-pod/app_kubernetes_io/instance:preview receiveTimestamp:2023-08-10T04:02:45.184541417Z\n- resource.type:k8s_container labels.k8s-pod/app_kubernetes_io/name:gateway logName:projects/fw-ai-cp-prod/logs/stderr labels.k8s-pod/app_kubernetes_io/instance:preview resource.labels.namespace_name:default labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-382c7a95-oo3q resource.labels.pod_name:gateway-preview-77f9d969b4-xfwx2 insertId:pgq1340gu9ixtvwc\n- labels.k8s-pod/app_kubernetes_io/instance:preview severity:ERROR labels.k8s-pod/app_kubernetes_io/name:gateway resource.type:k8s_container labels.k8s-pod/pod-template-hash:77f9d969b4 resource.labels.namespace_name:default resource.labels.cluster_name:control-plane-2 textPayload:\"[2023-08-10 04:02:45.011][1][debug][connection] [source/common/network/connection_impl.cc:139] [C14659] closing data_to_write=243 type=0\"\n- labels.k8s-pod/pod-template-hash:77f9d969b4 receiveTimestamp:2023-08-10T04:02:45.184541417Z logName:projects/fw-ai-cp-prod/logs/stderr labels.k8s-pod/app_kubernetes_io/instance:preview resource.labels.container_name:envoy timestamp:2023-08-10T04:02:45.012323446Z insertId:qcvrywidaav74xxd severity:ERROR\n- labels.k8s-pod/app_kubernetes_io/instance:preview labels.k8s-pod/pod-template-hash:77f9d969b4 resource.labels.container_name:envoy logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.pod_name:gateway-preview-77f9d969b4-xfwx2 labels.k8s-pod/app_kubernetes_io/name:gateway jsonPayload:{} resource.labels.namespace_name:default"}
{"query": "Find logs with severity marked as error for container named envoy in clusters named control-plane-2 in the us-west1 location during the first 20 minutes of August 10, 2023. Summarize the number of logs by the instance name tag of pods.", "request": "{\"query_str\": \"severity:ERROR resource.labels.container_name:envoy resource.labels.cluster_name:control-plane-2 resource.labels.location:us-west1\", \"groupby_fields\": [{\"path\": \"labels.k8s-pod/app_kubernetes_io/instance\", \"limit\": 10, \"order\": \"top\"}], \"aggregation_field\": \"count\", \"aggregation_function\": \"sum\", \"viz\": \"toplist\", \"start\": \"2023-08-10T00:00:00\", \"end\": \"2023-08-10T00:20:00\"}", "sample": "- resource.labels.pod_name:gateway-preview-77f9d969b4-xfwx2 receiveTimestamp:2023-08-10T04:02:45.184541417Z labels.k8s-pod/pod-template-hash:77f9d969b4 resource.type:k8s_container severity:ERROR resource.labels.namespace_name:default timestamp:2023-08-10T04:02:45.012303830Z resource.labels.cluster_name:control-plane-2\n- resource.labels.location:us-west1 labels.k8s-pod/app_kubernetes_io/instance:preview labels.k8s-pod/pod-template-hash:77f9d969b4 resource.labels.container_name:envoy resource.labels.namespace_name:default resource.labels.pod_name:gateway-preview-77f9d969b4-xfwx2 resource.type:k8s_container receiveTimestamp:2023-08-10T04:02:45.184541417Z\n- resource.labels.cluster_name:control-plane-2 receiveTimestamp:2023-08-10T04:02:45.184541417Z resource.labels.container_name:envoy logName:projects/fw-ai-cp-prod/logs/stderr labels.k8s-pod/pod-template-hash:77f9d969b4 resource.labels.location:us-west1 severity:ERROR resource.labels.project_id:fw-ai-cp-prod\n- resource.labels.project_id:fw-ai-cp-prod labels.k8s-pod/pod-template-hash:77f9d969b4 textPayload:\"'x-content-type-options', 'nosniff'\" receiveTimestamp:2023-08-10T04:02:45.184541417Z resource.labels.cluster_name:control-plane-2 resource.labels.namespace_name:default timestamp:2023-08-10T04:02:45.012284834Z resource.labels.location:us-west1\n- resource.labels.pod_name:gateway-preview-77f9d969b4-xfwx2 insertId:euuvl1egb8xdzmzr severity:ERROR labels.k8s-pod/app_kubernetes_io/instance:preview labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-382c7a95-oo3q resource.labels.project_id:fw-ai-cp-prod logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.container_name:envoy\n- labels.k8s-pod/pod-template-hash:77f9d969b4 insertId:y26mudju7ar4aygj resource.type:k8s_container resource.labels.container_name:envoy timestamp:2023-08-10T04:02:45.012274200Z resource.labels.location:us-west1 resource.labels.project_id:fw-ai-cp-prod labels.k8s-pod/app_kubernetes_io/instance:preview\n- resource.type:k8s_container labels.k8s-pod/app_kubernetes_io/name:gateway resource.labels.namespace_name:default labels.k8s-pod/pod-template-hash:77f9d969b4 labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-382c7a95-oo3q labels.k8s-pod/app_kubernetes_io/instance:preview resource.labels.project_id:fw-ai-cp-prod receiveTimestamp:2023-08-10T04:02:45.184541417Z\n- textPayload:\"[2023-08-10 04:02:45.011][1][debug][http] [source/common/http/conn_manager_impl.cc:1588] [C14659][S8203417758731455226] encoding headers via codec (end_stream=false):\" severity:ERROR resource.labels.location:us-west1 resource.labels.container_name:envoy resource.labels.cluster_name:control-plane-2 resource.labels.pod_name:gateway-preview-77f9d969b4-xfwx2 labels.k8s-pod/app_kubernetes_io/name:gateway resource.labels.namespace_name:default\n- resource.labels.project_id:fw-ai-cp-prod logName:projects/fw-ai-cp-prod/logs/stderr resource.type:k8s_container labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-382c7a95-oo3q resource.labels.location:us-west1 labels.k8s-pod/pod-template-hash:77f9d969b4 insertId:cp6zqmcet1mjjdxu receiveTimestamp:2023-08-10T04:02:45.184541417Z\n- insertId:gphqrocddyb8kg0j labels.k8s-pod/app_kubernetes_io/instance:preview resource.labels.project_id:fw-ai-cp-prod receiveTimestamp:2023-08-10T04:02:45.184541417Z resource.labels.namespace_name:default textPayload:\"[2023-08-10 04:02:45.011][1][debug][admin] [source/server/admin/admin_filter.cc:85] [C14659][S8203417758731455226] request complete: path: /ready\" timestamp:2023-08-10T04:02:45.012253361Z severity:ERROR"}
{"query": "Show a list of logs tagged as error from application named gateway in cluster control-plane-2 for instances starting with preview over the last hour sorted by container name.", "request": "{\"query_str\": \"severity:error labels.k8s-pod/app_kubernetes_io/name:gateway resource.labels.cluster_name:control-plane-2 labels.k8s-pod/app_kubernetes_io/instance:preview*\", \"groupby_fields\": [{\"path\": \"resource.labels.container_name\", \"limit\": 10, \"order\":\"top\"}], \"aggregation_function\": \"count\", \"aggregation_field\": \"count\", \"viz\": \"toplist\", \"start\": \"now-1h\", \"end\": \"now\"}", "sample": "- logName:projects/fw-ai-cp-prod/logs/stderr labels.k8s-pod/pod-template-hash:77f9d969b4 labels.k8s-pod/app_kubernetes_io/instance:preview textPayload:\"[2023-08-10 04:02:45.011][1][debug][connection] [./source/common/network/connection_impl.h:92] [C14659] current connecting state: false\" labels.k8s-pod/app_kubernetes_io/name:gateway receiveTimestamp:2023-08-10T04:02:45.184541417Z timestamp:2023-08-10T04:02:45.012247924Z resource.labels.cluster_name:control-plane-2\n- labels.k8s-pod/app_kubernetes_io/name:gateway resource.labels.project_id:fw-ai-cp-prod resource.labels.pod_name:gateway-preview-77f9d969b4-xfwx2 timestamp:2023-08-10T04:02:45.012242745Z labels.k8s-pod/pod-template-hash:77f9d969b4 labels.k8s-pod/app_kubernetes_io/instance:preview receiveTimestamp:2023-08-10T04:02:45.184541417Z resource.labels.cluster_name:control-plane-2\n- labels.k8s-pod/pod-template-hash:77f9d969b4 resource.labels.container_name:envoy resource.type:k8s_container resource.labels.namespace_name:default logName:projects/fw-ai-cp-prod/logs/stderr jsonPayload:{} insertId:dp6eoj47tnmpo808 resource.labels.cluster_name:control-plane-2\n- labels.k8s-pod/app_kubernetes_io/instance:preview resource.labels.namespace_name:default timestamp:2023-08-10T04:02:45.012232829Z resource.labels.pod_name:gateway-preview-77f9d969b4-xfwx2 resource.labels.container_name:envoy resource.labels.cluster_name:control-plane-2 resource.labels.location:us-west1 severity:ERROR\n- resource.labels.cluster_name:control-plane-2 resource.labels.location:us-west1 timestamp:2023-08-10T04:02:45.012227137Z textPayload:\"'accept', '*/*'\" severity:ERROR labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-382c7a95-oo3q resource.labels.project_id:fw-ai-cp-prod labels.k8s-pod/app_kubernetes_io/name:gateway\n- labels.k8s-pod/app_kubernetes_io/name:gateway resource.labels.namespace_name:default resource.labels.project_id:fw-ai-cp-prod labels.k8s-pod/app_kubernetes_io/instance:preview labels.k8s-pod/pod-template-hash:77f9d969b4 resource.labels.container_name:envoy severity:ERROR receiveTimestamp:2023-08-10T04:02:45.184541417Z\n- labels.k8s-pod/pod-template-hash:77f9d969b4 resource.labels.cluster_name:control-plane-2 textPayload:\"':method', 'GET'\" insertId:itig3s5d5sn03ot7 logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.location:us-west1 resource.type:k8s_container labels.k8s-pod/app_kubernetes_io/instance:preview\n- textPayload:\"':path', '/ready'\" labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-382c7a95-oo3q labels.k8s-pod/app_kubernetes_io/name:gateway severity:ERROR labels.k8s-pod/pod-template-hash:77f9d969b4 resource.labels.container_name:envoy timestamp:2023-08-10T04:02:45.012212702Z resource.labels.namespace_name:default\n- labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-382c7a95-oo3q logName:projects/fw-ai-cp-prod/logs/stderr textPayload:\"':authority', '10.5.4.35:1082'\" labels.k8s-pod/app_kubernetes_io/name:gateway resource.labels.pod_name:gateway-preview-77f9d969b4-xfwx2 resource.labels.namespace_name:default resource.labels.location:us-west1 resource.labels.project_id:fw-ai-cp-prod\n- resource.labels.container_name:envoy timestamp:2023-08-10T04:02:45.012183664Z labels.k8s-pod/app_kubernetes_io/name:gateway resource.labels.pod_name:gateway-preview-77f9d969b4-xfwx2 severity:ERROR logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.cluster_name:control-plane-2 labels.k8s-pod/app_kubernetes_io/instance:preview"}
{"query": "Find logs marked with severity as error for the fw-ai-cp-prod project coming from the control-plane-2 cluster on August 10, 2023. Calculate the unique count of these logs related to each Kubernetes pod, and visualize this data as a treemap.", "request": "{\"query_str\": \"severity:ERROR resource.labels.project_id:fw-ai-cp-prod resource.labels.cluster_name:control-plane-2 timestamp:2023-08-10\", \"groupby_fields\": [{\"path\":\"resource.labels.pod_name\", \"limit\":10, \"order\":\"top\"}], \"aggregation_function\": \"count_unique\", \"aggregation_field\": \"resource.labels.pod_name\", \"viz\": \"treemap\", \"start\": \"2023-08-10T00:00:00Z\", \"end\": \"2023-08-10T23:59:59Z\"}", "sample": "- severity:ERROR timestamp:2023-08-10T04:02:45.012157996Z resource.labels.project_id:fw-ai-cp-prod receiveTimestamp:2023-08-10T04:02:45.184541417Z logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.pod_name:gateway-preview-77f9d969b4-xfwx2 resource.labels.container_name:envoy resource.type:k8s_container\n- resource.labels.container_name:envoy resource.labels.project_id:fw-ai-cp-prod resource.labels.cluster_name:control-plane-2 labels.k8s-pod/pod-template-hash:77f9d969b4 severity:ERROR insertId:t9w2et4vee2ajcqo textPayload:\"[2023-08-10 04:02:45.011][1][debug][connection] [source/common/network/connection_impl.cc:139] [C14658] closing data_to_write=243 type=2\" resource.labels.pod_name:gateway-preview-77f9d969b4-xfwx2\n- timestamp:2023-08-10T04:02:45.012146952Z resource.labels.container_name:envoy labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-382c7a95-oo3q resource.labels.pod_name:gateway-preview-77f9d969b4-xfwx2 logName:projects/fw-ai-cp-prod/logs/stderr resource.type:k8s_container resource.labels.namespace_name:default resource.labels.cluster_name:control-plane-2\n- labels.k8s-pod/pod-template-hash:77f9d969b4 labels.k8s-pod/app_kubernetes_io/name:gateway labels.k8s-pod/app_kubernetes_io/instance:preview resource.labels.namespace_name:default resource.labels.project_id:fw-ai-cp-prod textPayload:\"[2023-08-10 04:02:45.011][1][debug][misc] [source/server/admin/admin_filter.cc:101] nextChunk: response.length=5 more_data=false end_stream=true\" resource.labels.cluster_name:control-plane-2 labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-382c7a95-oo3q\n- resource.labels.container_name:envoy resource.labels.namespace_name:default resource.labels.cluster_name:control-plane-2 labels.k8s-pod/app_kubernetes_io/instance:preview logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.pod_name:gateway-preview-77f9d969b4-xfwx2 insertId:krvr8tswobtiqkmf timestamp:2023-08-10T04:02:45.012135928Z\n- labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-382c7a95-oo3q logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.cluster_name:control-plane-2 receiveTimestamp:2023-08-10T04:02:45.184541417Z resource.type:k8s_container insertId:wc18o22gmpjufscd labels.k8s-pod/app_kubernetes_io/name:gateway resource.labels.location:us-west1\n- resource.labels.pod_name:gateway-preview-77f9d969b4-xfwx2 timestamp:2023-08-10T04:02:45.012126031Z logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.container_name:envoy receiveTimestamp:2023-08-10T04:02:45.184541417Z labels.k8s-pod/app_kubernetes_io/instance:preview resource.labels.project_id:fw-ai-cp-prod labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-382c7a95-oo3q\n- resource.labels.pod_name:gateway-preview-77f9d969b4-xfwx2 resource.labels.cluster_name:control-plane-2 resource.labels.namespace_name:default labels.k8s-pod/app_kubernetes_io/name:gateway labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-382c7a95-oo3q resource.labels.location:us-west1 labels.k8s-pod/pod-template-hash:77f9d969b4 logName:projects/fw-ai-cp-prod/logs/stderr\n- timestamp:2023-08-10T04:02:45.012114579Z labels.k8s-pod/pod-template-hash:77f9d969b4 severity:ERROR labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-382c7a95-oo3q labels.k8s-pod/app_kubernetes_io/name:gateway receiveTimestamp:2023-08-10T04:02:45.184541417Z resource.labels.project_id:fw-ai-cp-prod resource.labels.container_name:envoy\n- timestamp:2023-08-10T04:02:45.012109623Z resource.type:k8s_container resource.labels.project_id:fw-ai-cp-prod resource.labels.namespace_name:default logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.cluster_name:control-plane-2 labels.k8s-pod/pod-template-hash:77f9d969b4 receiveTimestamp:2023-08-10T04:02:45.184541417Z"}
{"query": "Show a breakdown of error logs for the preview instance of the gateway application within cluster control-plane-2 in the last 24 hours, grouped by pod_template_hash in a sunburst visualization.", "request": "{\"query_str\": \"severity:ERROR labels.k8s-pod/app_kubernetes_io/name:gateway labels.k8s-pod/app_kubernetes_io/instance:preview resource.labels.cluster_name:control-plane-2\", \"groupby_fields\": [{\"path\": \"labels.k8s-pod/pod-template-hash\", \"limit\": 10, \"order\": \"top\"}], \"aggregation_function\": \"count\", \"aggregation_field\": \"count\", \"viz\": \"sunburst\", \"start\": \"now-24h\", \"end\": \"now\"}", "sample": "- logName:projects/fw-ai-cp-prod/logs/stderr resource.type:k8s_container textPayload:\"'content-type', 'text/plain; charset=UTF-8'\" resource.labels.namespace_name:default resource.labels.project_id:fw-ai-cp-prod labels.k8s-pod/app_kubernetes_io/instance:preview severity:ERROR labels.k8s-pod/pod-template-hash:77f9d969b4\n- resource.labels.container_name:envoy labels.k8s-pod/app_kubernetes_io/name:gateway labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-382c7a95-oo3q logName:projects/fw-ai-cp-prod/logs/stderr textPayload:\"':status', '200'\" receiveTimestamp:2023-08-10T04:02:45.184541417Z resource.labels.cluster_name:control-plane-2 timestamp:2023-08-10T04:02:45.012098465Z\n- logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.project_id:fw-ai-cp-prod insertId:vkamcvpoc9x7isih resource.labels.namespace_name:default labels.k8s-pod/app_kubernetes_io/instance:preview textPayload:\"[2023-08-10 04:02:45.011][1][debug][http] [source/common/http/conn_manager_impl.cc:1588] [C14658][S6378436045906252965] encoding headers via codec (end_stream=false):\" resource.labels.pod_name:gateway-preview-77f9d969b4-xfwx2 severity:ERROR\n- labels.k8s-pod/app_kubernetes_io/name:gateway textPayload:\"[2023-08-10 04:02:45.011][1][debug][http] [source/common/http/conn_manager_impl.cc:1530] [C14658][S6378436045906252965] closing connection due to connection close header\" receiveTimestamp:2023-08-10T04:02:45.184541417Z logName:projects/fw-ai-cp-prod/logs/stderr labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-382c7a95-oo3q resource.labels.pod_name:gateway-preview-77f9d969b4-xfwx2 resource.labels.namespace_name:default labels.k8s-pod/app_kubernetes_io/instance:preview\n- resource.labels.project_id:fw-ai-cp-prod resource.labels.container_name:envoy labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-382c7a95-oo3q resource.labels.pod_name:gateway-preview-77f9d969b4-xfwx2 severity:ERROR resource.labels.cluster_name:control-plane-2 receiveTimestamp:2023-08-10T04:02:45.184541417Z insertId:an9649jhopmw4h86\n- timestamp:2023-08-10T04:02:45.011655232Z labels.k8s-pod/pod-template-hash:77f9d969b4 logName:projects/fw-ai-cp-prod/logs/stderr textPayload:\"[2023-08-10 04:02:45.011][1][debug][connection] [./source/common/network/connection_impl.h:92] [C14658] current connecting state: false\" resource.labels.namespace_name:default resource.labels.pod_name:gateway-preview-77f9d969b4-xfwx2 resource.labels.cluster_name:control-plane-2 resource.labels.location:us-west1\n- resource.labels.namespace_name:default textPayload:\"[2023-08-10 04:02:45.011][1][debug][http] [source/common/http/conn_manager_impl.cc:955] [C14658][S6378436045906252965] request end stream\" resource.labels.cluster_name:control-plane-2 receiveTimestamp:2023-08-10T04:02:45.184541417Z labels.k8s-pod/app_kubernetes_io/name:gateway resource.labels.pod_name:gateway-preview-77f9d969b4-xfwx2 labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-382c7a95-oo3q resource.labels.project_id:fw-ai-cp-prod\n- labels.k8s-pod/app_kubernetes_io/instance:preview timestamp:2023-08-10T04:02:45.011644824Z resource.labels.project_id:fw-ai-cp-prod resource.type:k8s_container labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-382c7a95-oo3q jsonPayload:{} resource.labels.container_name:envoy insertId:8wfcm0nmrd1r0wqk\n- labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-382c7a95-oo3q labels.k8s-pod/pod-template-hash:77f9d969b4 severity:ERROR resource.type:k8s_container resource.labels.namespace_name:default labels.k8s-pod/app_kubernetes_io/instance:preview textPayload:\"'connection', 'close'\" insertId:uya82obug133vb34\n- resource.labels.container_name:envoy textPayload:\"'accept', '*/*'\" resource.labels.namespace_name:default labels.k8s-pod/app_kubernetes_io/instance:preview severity:ERROR labels.k8s-pod/pod-template-hash:77f9d969b4 timestamp:2023-08-10T04:02:45.011635405Z resource.type:k8s_container"}
{"query": "Generate a stream of logs marked as error from services running in a container with the ID starting with b2033c9 in the fw-ai-cp-prod project, logged on August 10, 2023.", "request": "{\"query_str\": \"resource.labels.project_id:fw-ai-cp-prod container_id:b2033c9* timestamp:2023-08-10T* severity:ERROR\", \"groupby_fields\": [], \"aggregation_function\": \"\", \"aggregation_field\": \"\", \"viz\": \"stream\", \"start\": \"2023-08-10T00:00:00\", \"end\": \"2023-08-10T23:59:59\"}", "sample": "- labels.k8s-pod/app_kubernetes_io/name:gateway resource.type:k8s_container timestamp:2023-08-10T04:02:45.011630467Z textPayload:\"'user-agent', 'kube-probe/1.26'\" logName:projects/fw-ai-cp-prod/logs/stderr labels.k8s-pod/app_kubernetes_io/instance:preview resource.labels.namespace_name:default insertId:2v37wgn8p2d6y0r2\n- labels.k8s-pod/app_kubernetes_io/name:gateway resource.labels.namespace_name:default resource.labels.container_name:envoy labels.k8s-pod/pod-template-hash:77f9d969b4 labels.k8s-pod/app_kubernetes_io/instance:preview labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-382c7a95-oo3q logName:projects/fw-ai-cp-prod/logs/stderr timestamp:2023-08-10T04:02:45.011624667Z\n- resource.labels.location:us-west1 timestamp:2023-08-10T04:02:45.011619751Z severity:ERROR logName:projects/fw-ai-cp-prod/logs/stderr textPayload:\"':path', '/ready'\" resource.labels.project_id:fw-ai-cp-prod resource.labels.pod_name:gateway-preview-77f9d969b4-xfwx2 receiveTimestamp:2023-08-10T04:02:45.184541417Z\n- timestamp:2023-08-10T04:02:45.011614100Z resource.labels.cluster_name:control-plane-2 textPayload:\"':authority', '10.5.4.35:1082'\" resource.labels.container_name:envoy resource.labels.pod_name:gateway-preview-77f9d969b4-xfwx2 resource.type:k8s_container resource.labels.project_id:fw-ai-cp-prod logName:projects/fw-ai-cp-prod/logs/stderr\n- resource.labels.location:us-west1 resource.type:k8s_container receiveTimestamp:2023-08-10T04:02:45.184541417Z textPayload:\"[2023-08-10 04:02:45.011][1][debug][http] [source/common/http/conn_manager_impl.cc:972] [C14658][S6378436045906252965] request headers complete (end_stream=true):\" labels.k8s-pod/app_kubernetes_io/name:gateway insertId:lpmdhzzyydj5bn0u resource.labels.cluster_name:control-plane-2 resource.labels.project_id:fw-ai-cp-prod\n- resource.type:k8s_container labels.k8s-pod/app_kubernetes_io/name:gateway resource.labels.cluster_name:control-plane-2 severity:ERROR resource.labels.container_name:envoy textPayload:\"[2023-08-10 04:02:45.011][1][debug][http] [source/common/http/conn_manager_impl.cc:306] [C14658] new stream\" resource.labels.namespace_name:default timestamp:2023-08-10T04:02:45.011583800Z\n- labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-382c7a95-oo3q textPayload:\"[2023-08-10 04:02:45.010][1][debug][conn_handler] [source/extensions/listener_managers/listener_manager/active_tcp_listener.cc:147] [C14659] new connection from 10.5.4.1:38702\" timestamp:2023-08-10T04:02:45.011105850Z resource.type:k8s_container insertId:abg319p9uosjm96z logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.cluster_name:control-plane-2 labels.k8s-pod/pod-template-hash:77f9d969b4\n- severity:ERROR resource.labels.location:us-west1 resource.labels.project_id:fw-ai-cp-prod logName:projects/fw-ai-cp-prod/logs/stderr labels.k8s-pod/app_kubernetes_io/name:gateway resource.labels.pod_name:gateway-preview-77f9d969b4-xfwx2 labels.k8s-pod/pod-template-hash:77f9d969b4 resource.labels.cluster_name:control-plane-2\n- resource.labels.service:monitoring.googleapis.com protoPayload.requestMetadata.callerNetwork://compute.googleapis.com/projects/fw-ai-cp-prod/global/networks/__unknown__ protoPayload.status.message:\"Permission monitoring.timeSeries.create denied (or the resource may not exist).\" protoPayload.requestMetadata.requestAttributes.auth:{} protoPayload.serviceName:monitoring.googleapis.com protoPayload.request.@type:type.googleapis.com/google.monitoring.v3.CreateTimeSeriesRequest logName:projects/fw-ai-cp-prod/logs/cloudaudit.googleapis.com%2Fdata_access protoPayload.authenticationInfo.principalSubject:serviceAccount:fireworks-control-plane@fw-ai-cp-prod.iam.gserviceaccount.com protoPayload.authorizationInfo[0].resource:331150806335 protoPayload.resourceName:projects/fw-ai-cp-prod protoPayload.authorizationInfo[0].resourceAttributes:{} severity:ERROR resource.labels.project_id:fw-ai-cp-prod protoPayload.authenticationInfo.principalEmail:fireworks-control-plane@fw-ai-cp-prod.iam.gserviceaccount.com\n- receiveTimestamp:2023-08-10T04:02:48.779804393Z labels.k8s-pod/pod-template-hash:66f55647f4 resource.labels.namespace_name:default labels.k8s-pod/app_kubernetes_io/instance:dev-dzhulgakov resource.type:k8s_container resource.labels.project_id:fw-ai-cp-prod timestamp:2023-08-10T04:02:44.665450832Z logName:projects/fw-ai-cp-prod/logs/stderr"}
{"query": "Produce a count of error severity logs from the control plane 2 cluster on August 10, 2023, associated with the gateway application on Kubernetes, grouped by the hash of the pod template. Represent this as a toplist.", "request": "{\"query_str\": \"resource.labels.cluster_name:control-plane-2 severity:ERROR labels.k8s-pod/app_kubernetes_io/name:gateway\", \"groupby_fields\": [{\"path\":\"labels.k8s-pod/pod-template-hash\", \"limit\":10, \"order\":\"top\"}], \"aggregation_function\": \"count\", \"aggregation_field\": \"count\", \"viz\": \"toplist\", \"start\": \"2023-08-10T00:00:00\", \"end\": \"2023-08-10T23:59:59\"}", "sample": "- receiveTimestamp:2023-08-10T04:02:48.779804393Z logName:projects/fw-ai-cp-prod/logs/stderr resource.type:k8s_container timestamp:2023-08-10T04:02:44.665441792Z insertId:x8ctix16ljm7i20o resource.labels.location:us-west1 textPayload:\"[2023-08-10 04:02:44.665][1][debug][upstream] [source/extensions/clusters/logical_dns/logical_dns_cluster.cc:116] async DNS resolution complete for 127.0.0.1\" resource.labels.cluster_name:control-plane-2\n- logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.pod_name:gateway-dev-dzhulgakov-66f55647f4-4c6p8 labels.k8s-pod/app_kubernetes_io/instance:dev-dzhulgakov resource.type:k8s_container resource.labels.cluster_name:control-plane-2 labels.k8s-pod/app_kubernetes_io/name:gateway insertId:wxf9ln2dcrcfw0n9 resource.labels.container_name:envoy\n- resource.labels.pod_name:gateway-dev-dzhulgakov-66f55647f4-4c6p8 resource.labels.location:us-west1 labels.k8s-pod/pod-template-hash:66f55647f4 textPayload:\"[2023-08-10 04:02:44.663][1][debug][dns] [source/extensions/network/dns_resolver/cares/dns_impl.cc:354] dns resolution for 127.0.0.1 started\" severity:ERROR logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.namespace_name:default resource.labels.container_name:envoy\n- severity:ERROR timestamp:2023-08-10T04:02:44.663649313Z resource.labels.container_name:envoy resource.labels.namespace_name:default labels.k8s-pod/app_kubernetes_io/instance:dev-dzhulgakov logName:projects/fw-ai-cp-prod/logs/stderr labels.k8s-pod/app_kubernetes_io/name:gateway labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-43c3fe28-geam\n- protoPayload.authenticationInfo.principalSubject:serviceAccount:inference@fw-ai-cp-prod.iam.gserviceaccount.com protoPayload.authorizationInfo[0].resource:331150806335 protoPayload.requestMetadata.destinationAttributes:{} insertId:sv2yykeytruh protoPayload.authorizationInfo[0].resourceAttributes:{} resource.labels.method:google.monitoring.v3.MetricService.CreateTimeSeries timestamp:2023-08-10T04:02:44.632805993Z protoPayload.status.code:7 protoPayload.requestMetadata.callerIp:34.173.111.183 protoPayload.authenticationInfo.serviceAccountDelegationInfo[0].firstPartyPrincipal.principalEmail:service-331150806335@compute-system.iam.gserviceaccount.com protoPayload.authorizationInfo[0].permission:monitoring.timeSeries.create protoPayload.serviceName:monitoring.googleapis.com protoPayload.authenticationInfo.principalEmail:inference@fw-ai-cp-prod.iam.gserviceaccount.com protoPayload.status.message:\"Permission monitoring.timeSeries.create denied (or the resource may not exist).\"\n- jsonPayload._STREAM_ID:435a53b7e4254b48be3422286bf1e41a resource.labels.cluster_name:control-plane-2 resource.labels.node_name:gke-control-plane-2-gateway-pool-43c3fe28-geam jsonPayload._CMDLINE:\"/home/kubernetes/bin/kubelet --v=2 --cloud-provider=external --experimental-mounter-path=/home/kubernetes/containerized_mounter/mounter --cert-dir=/var/lib/kubelet/pki/ --kubeconfig=/var/lib/kubelet/kubeconfig --max-pods=110 --register-with-taints=deployment=gateway:NoExecute --volume-plugin-dir=/home/kubernetes/flexvolume --node-status-max-images=25 --container-runtime=remote --container-runtime-endpoint=unix:///run/containerd/containerd.sock --runtime-cgroups=/system.slice/containerd.service --registry-qps=10 --registry-burst=20 --config /home/kubernetes/kubelet-config.yaml \"--pod-sysctls=net.core.somaxconn=1024,net.ipv4.conf.all.accept_redirects=0,net.ipv4.conf.all.forwarding=1,net.ipv4.conf.all.route_localnet=1,net.ipv4.conf.default.forwarding=1,net.ipv4.ip_forward=1,net.ipv4.tcp_fin_timeout=60,net.ipv4.tcp_keepalive_intvl=60,net.ipv4.tcp_keepalive_probes=5,net.ipv4.tcp_keepalive_time=300,net.ipv4.tcp_rmem=4096 87380 6291456,net.ipv4.tcp_syn_retries=6,net.ipv4.tcp_tw_reuse=0,net.ipv4.tcp_wmem=4096 16384 4194304,net.ipv4.udp_rmem_min=4096,net.ipv4.udp_wmem_min=4096,net.ipv6.conf.all.disable_ipv6=1,net.ipv6.conf.default.accept_ra=0,net.ipv6.conf.default.disable_ipv6=1,net.netfilter.nf_conntrack_generic_timeout=600,net.netfilter.nf_conntrack_tcp_be_liberal=1,net.netfilter.nf_conntrack_tcp_timeout_close_wait=3600,net.netfilter.nf_conntrack_tcp_timeout_established=86400\" --pod-infra-container-image=gke.gcr.io/pause:3.8@sha256:880e63f94b145e46f1b1082bb71b85e21f16b99b180b9996407d61240ceb9830\" jsonPayload._PID:1987 jsonPayload._SYSTEMD_UNIT:kubelet.service jsonPayload.PRIORITY:6 receiveTimestamp:2023-08-10T04:02:48.717822903Z resource.type:k8s_node jsonPayload._SYSTEMD_INVOCATION_ID:538edeff927045999991c67469b38b0d resource.labels.location:us-west1 jsonPayload._GID:0 jsonPayload._EXE:/home/kubernetes/bin/kubelet jsonPayload._BOOT_ID:24b8156fb06c45aca0858478198968a0\n- protoPayload.requestMetadata.callerSuppliedUserAgent:\"opentelemetry-collector-contrib \"1.8.3-gke.4\" grpc-go/1.45.0,gzip(gfe)\" protoPayload.requestMetadata.destinationAttributes:{} resource.labels.method:google.monitoring.v3.MetricService.CreateServiceTimeSeries resource.labels.service:monitoring.googleapis.com protoPayload.requestMetadata.callerIp:34.83.180.15 protoPayload.request.name:projects/331150806335 receiveTimestamp:2023-08-10T04:02:45.384689678Z resource.type:audited_resource protoPayload.authorizationInfo[0].resource:331150806335 protoPayload.authenticationInfo.principalSubject:serviceAccount:service-331150806335@container-engine-robot.iam.gserviceaccount.com protoPayload.@type:type.googleapis.com/google.cloud.audit.AuditLog protoPayload.serviceName:monitoring.googleapis.com logName:projects/fw-ai-cp-prod/logs/cloudaudit.googleapis.com%2Fdata_access\n- resource.labels.location:us-west1 operation.last:True protoPayload.requestMetadata.callerIp:172.16.0.38 protoPayload.requestMetadata.callerSuppliedUserAgent:\"csi-snapshotter/v0.0.0 (linux/amd64) kubernetes/$Format\" protoPayload.authorizationInfo[0].resource:coordination.k8s.io/v1/namespaces/kube-system/leases/external-snapshotter-leader-pd-csi-storage-gke-io resource.labels.project_id:fw-ai-cp-prod resource.labels.cluster_name:control-plane-2 protoPayload.@type:type.googleapis.com/google.cloud.audit.AuditLog protoPayload.serviceName:k8s.io protoPayload.methodName:io.k8s.coordination.v1.leases.update receiveTimestamp:2023-08-10T04:02:47.284633980Z protoPayload.status.code:0\n- logName:projects/fw-ai-cp-prod/logs/stderr labels.k8s-pod/pod-template-hash:75fc95c5cc resource.labels.container_name:envoy insertId:3wicd0asqqf18bry severity:ERROR resource.labels.cluster_name:control-plane-2 timestamp:2023-08-10T04:02:44.574930350Z labels.k8s-pod/app_kubernetes_io/name:gateway\n- resource.labels.container_name:envoy resource.labels.cluster_name:control-plane-2 labels.k8s-pod/app_kubernetes_io/instance:dev-divchenko insertId:jp8o0zlpmwo2gj4d logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.pod_name:gateway-dev-divchenko-75fc95c5cc-kbsc5 labels.k8s-pod/pod-template-hash:75fc95c5cc timestamp:2023-08-10T04:02:44.574917190Z"}
{"query": "Count of error logs from the gateway application in the control plane 2 cluster, grouped by the error message and represented in a timeseries visualization for logs after 04:02 am on August 10, 2023.", "request": "{\"query_str\": \"resource.labels.cluster_name:control-plane-2 labels.k8s-pod/app_kubernetes_io/name:gateway severity:ERROR\", \"groupby_fields\": [{\"path\":\"error_msg\", \"limit\":10, \"order\":\"top\"}], \"aggregation_function\": \"count\", \"aggregation_field\": \"count\", \"viz\": \"timeseries\", \"start\": \"2023-08-10T04:02:00\", \"end\": \"now\"}", "sample": "- labels.k8s-pod/pod-template-hash:75fc95c5cc resource.labels.container_name:envoy resource.labels.cluster_name:control-plane-2 insertId:jkyuhqpp4nq0jja2 timestamp:2023-08-10T04:02:44.574840140Z labels.k8s-pod/app_kubernetes_io/instance:dev-divchenko resource.labels.pod_name:gateway-dev-divchenko-75fc95c5cc-kbsc5 severity:ERROR\n- resource.labels.project_id:fw-ai-cp-prod logName:projects/fw-ai-cp-prod/logs/stderr labels.k8s-pod/app_kubernetes_io/name:gateway labels.k8s-pod/app_kubernetes_io/instance:dev-divchenko receiveTimestamp:2023-08-10T04:02:44.728042945Z timestamp:2023-08-10T04:02:44.564817Z resource.type:k8s_container resource.labels.namespace_name:default\n- labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q timestamp:2023-08-10T04:02:44.564759840Z textPayload:\"[2023-08-10 04:02:44.564][1][debug][upstream] [source/extensions/clusters/logical_dns/logical_dns_cluster.cc:108] starting async DNS resolution for 127.0.0.1\" severity:ERROR resource.labels.namespace_name:default resource.labels.container_name:envoy logName:projects/fw-ai-cp-prod/logs/stderr insertId:hwdalykufske8gw8\n- protoPayload.resourceName:coordination.k8s.io/v1/namespaces/knative-serving/leases/net-istio-controller.knative.dev.net-istio.pkg.reconciler.ingress.reconciler.00-of-01 operation.last:True receiveTimestamp:2023-08-10T04:02:44.633472885Z protoPayload.methodName:io.k8s.coordination.v1.leases.update protoPayload.authorizationInfo[0].permission:io.k8s.coordination.v1.leases.update protoPayload.authenticationInfo.principalEmail:system:serviceaccount:knative-serving:controller operation.producer:k8s.io logName:projects/fw-ai-cp-prod/logs/cloudaudit.googleapis.com%2Factivity resource.labels.location:us-central1-a resource.labels.cluster_name:inference-1 insertId:ac81e1b8-3017-41b6-b248-5fb6a8e981e1 protoPayload.@type:type.googleapis.com/google.cloud.audit.AuditLog\n- protoPayload.serviceName:k8s.io resource.labels.cluster_name:inference-1 operation.producer:k8s.io operation.last:True resource.type:k8s_cluster protoPayload.requestMetadata.callerIp:10.248.1.22 protoPayload.authorizationInfo[0].resource:coordination.k8s.io/v1/namespaces/knative-serving/leases/net-istio-controller.knative.dev.net-istio.pkg.reconciler.serverlessservice.reconciler.00-of-01 operation.first:True protoPayload.authorizationInfo[0].granted:True protoPayload.methodName:io.k8s.coordination.v1.leases.update logName:projects/fw-ai-cp-prod/logs/cloudaudit.googleapis.com%2Factivity protoPayload.requestMetadata.callerSuppliedUserAgent:\"controller/v0.0.0 (linux/amd64) kubernetes/$Format\"\n- resource.labels.pod_name:gateway-dev-zchenyu-69fb9f646f-7pw2t receiveTimestamp:2023-08-10T04:02:44.741842839Z labels.k8s-pod/pod-template-hash:69fb9f646f resource.labels.namespace_name:default resource.type:k8s_container resource.labels.cluster_name:control-plane-2 labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q insertId:5btv425hp9rw1yib\n- protoPayload.authorizationInfo[0].resource:coordination.k8s.io/v1/namespaces/kube-system/leases/gcp-controller-manager operation.first:True protoPayload.requestMetadata.callerIp:172.16.0.38 resource.labels.project_id:fw-ai-cp-prod receiveTimestamp:2023-08-10T04:02:45.346650087Z protoPayload.methodName:io.k8s.coordination.v1.leases.update operation.last:True protoPayload.serviceName:k8s.io resource.type:k8s_cluster protoPayload.resourceName:coordination.k8s.io/v1/namespaces/kube-system/leases/gcp-controller-manager operation.producer:k8s.io insertId:4e42ef4a-b843-4829-afd9-fc8c55de8ec9\n- resource.type:k8s_container resource.labels.container_name:envoy resource.labels.pod_name:gateway-66b8b7c9b8-v8wfc textPayload:\"[2023-08-10 04:02:44.415][1][debug][conn_handler] [source/extensions/listener_managers/listener_manager/active_stream_listener_base.cc:120] [C14774] adding to cleanup list\" labels.k8s-pod/pod-template-hash:66b8b7c9b8 labels.k8s-pod/app_kubernetes_io/name:gateway resource.labels.project_id:fw-ai-cp-prod receiveTimestamp:2023-08-10T04:02:44.780775649Z\n- resource.labels.cluster_name:control-plane-2 insertId:yietn99y3uircyb6 resource.labels.location:us-west1 resource.labels.pod_name:gateway-66b8b7c9b8-v8wfc resource.labels.container_name:envoy timestamp:2023-08-10T04:02:44.415400231Z receiveTimestamp:2023-08-10T04:02:44.780775649Z resource.labels.project_id:fw-ai-cp-prod\n- resource.labels.project_id:fw-ai-cp-prod resource.type:k8s_container timestamp:2023-08-10T04:02:44.415379681Z labels.k8s-pod/app_kubernetes_io/name:gateway logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.location:us-west1 receiveTimestamp:2023-08-10T04:02:44.780775649Z resource.labels.pod_name:gateway-66b8b7c9b8-v8wfc"}
{"query": "In the most recent hour, what are the unique pod names that have recorded errors in Kubernetes container logs from the prod instance of the gateway application in the control-plane-2 cluster of the fw-ai-cp-prod project? Display the results as a scatterplot.", "request": "{\"query_str\": \"resource.labels.project_id:fw-ai-cp-prod resource.labels.container_name:envoy labels.k8s-pod/app_kubernetes_io/name:gateway labels.k8s-pod/app_kubernetes_io/instance:prod resource.labels.cluster_name:control-plane-2 severity:ERROR\", \"groupby_fields\": [{\"path\":\"resource.labels.pod_name\", \"limit\":10, \"order\":\"top\"}], \"aggregation_function\": \"count_unique\", \"aggregation_field\": \"resource.labels.pod_name\", \"viz\": \"scatterplot\", \"start\": \"now-1h\", \"end\": \"now\"}", "sample": "- labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q resource.labels.container_name:envoy timestamp:2023-08-10T04:02:44.414744851Z resource.labels.project_id:fw-ai-cp-prod labels.k8s-pod/app_kubernetes_io/instance:prod resource.labels.location:us-west1 resource.type:k8s_container severity:ERROR\n- labels.k8s-pod/app_kubernetes_io/instance:prod labels.k8s-pod/pod-template-hash:66b8b7c9b8 resource.type:k8s_container timestamp:2023-08-10T04:02:44.414741221Z severity:ERROR receiveTimestamp:2023-08-10T04:02:44.780775649Z labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q resource.labels.project_id:fw-ai-cp-prod\n- textPayload:\"'server', 'envoy'\" resource.type:k8s_container labels.k8s-pod/app_kubernetes_io/name:gateway logName:projects/fw-ai-cp-prod/logs/stderr labels.k8s-pod/pod-template-hash:66b8b7c9b8 resource.labels.container_name:envoy receiveTimestamp:2023-08-10T04:02:44.780775649Z resource.labels.namespace_name:default\n- resource.labels.location:us-west1 resource.labels.project_id:fw-ai-cp-prod timestamp:2023-08-10T04:02:44.414734161Z severity:ERROR resource.labels.container_name:envoy labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q labels.k8s-pod/app_kubernetes_io/name:gateway receiveTimestamp:2023-08-10T04:02:44.780775649Z\n- resource.labels.project_id:fw-ai-cp-prod logName:projects/fw-ai-cp-prod/logs/stderr insertId:j40ta1zb6rviirzo resource.type:k8s_container labels.k8s-pod/pod-template-hash:66b8b7c9b8 severity:ERROR resource.labels.container_name:envoy timestamp:2023-08-10T04:02:44.414730441Z\n- textPayload:\"'cache-control', 'no-cache, max-age=0'\" timestamp:2023-08-10T04:02:44.414726891Z resource.type:k8s_container resource.labels.pod_name:gateway-66b8b7c9b8-v8wfc labels.k8s-pod/app_kubernetes_io/instance:prod logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.project_id:fw-ai-cp-prod labels.k8s-pod/pod-template-hash:66b8b7c9b8\n- resource.labels.container_name:envoy labels.k8s-pod/app_kubernetes_io/name:gateway resource.labels.cluster_name:control-plane-2 resource.labels.location:us-west1 resource.labels.pod_name:gateway-66b8b7c9b8-v8wfc labels.k8s-pod/app_kubernetes_io/instance:prod severity:ERROR logName:projects/fw-ai-cp-prod/logs/stderr\n- resource.labels.namespace_name:default insertId:yjc5cogax1xn97es resource.labels.cluster_name:control-plane-2 resource.labels.project_id:fw-ai-cp-prod resource.labels.location:us-west1 labels.k8s-pod/app_kubernetes_io/name:gateway textPayload:\"':status', '200'\" resource.type:k8s_container\n- resource.labels.location:us-west1 resource.labels.namespace_name:default severity:ERROR timestamp:2023-08-10T04:02:44.414715061Z insertId:30i74amulp4xjyj9 resource.labels.project_id:fw-ai-cp-prod labels.k8s-pod/pod-template-hash:66b8b7c9b8 resource.labels.pod_name:gateway-66b8b7c9b8-v8wfc\n- resource.labels.cluster_name:control-plane-2 insertId:zh4fyo6gysnd96y6 resource.labels.namespace_name:default receiveTimestamp:2023-08-10T04:02:44.780775649Z resource.type:k8s_container severity:ERROR logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.location:us-west1"}
{"query": "Compute the latest 15 unique clusters in us-west1 zone that recorded errors within the Kubernetes container logs labeled gateway for the project fw-ai-cp-prod on August 10, 2023. Display the results as a toplist.", "request": "{\"query_str\": \"severity:ERROR labels.k8s-pod/app_kubernetes_io/name:gateway resource.labels.project_id:fw-ai-cp-prod resource.labels.location:us-west1 timestamp:2023-08-10T*\", \"groupby_fields\": [{\"path\":\"resource.labels.cluster_name\", \"limit\":15, \"order\":\"top\"}], \"aggregation_function\": \"count_unique\", \"aggregation_field\": \"resource.labels.cluster_name\", \"viz\": \"toplist\", \"start\": \"2023-08-10T00:00:00\", \"end\": \"2023-08-10T23:59:59\"}", "sample": "- labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q insertId:kyoxrqdkcln4v6yh resource.labels.pod_name:gateway-66b8b7c9b8-v8wfc severity:ERROR timestamp:2023-08-10T04:02:44.414706751Z labels.k8s-pod/app_kubernetes_io/instance:prod resource.labels.location:us-west1 resource.type:k8s_container\n- insertId:xmkjrzeinf2ox11s resource.type:k8s_container resource.labels.project_id:fw-ai-cp-prod labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q resource.labels.namespace_name:default resource.labels.location:us-west1 severity:ERROR resource.labels.cluster_name:control-plane-2\n- resource.labels.project_id:fw-ai-cp-prod resource.labels.namespace_name:default severity:ERROR jsonPayload:{} labels.k8s-pod/pod-template-hash:66b8b7c9b8 labels.k8s-pod/app_kubernetes_io/name:gateway resource.labels.pod_name:gateway-66b8b7c9b8-v8wfc resource.labels.location:us-west1\n- logName:projects/fw-ai-cp-prod/logs/stderr labels.k8s-pod/app_kubernetes_io/instance:prod resource.labels.location:us-west1 labels.k8s-pod/pod-template-hash:66b8b7c9b8 textPayload:\"'connection', 'Keep-alive'\" resource.labels.container_name:envoy resource.labels.pod_name:gateway-66b8b7c9b8-v8wfc resource.labels.namespace_name:default\n- textPayload:\"'user-agent', 'GoogleHC/1.0'\" resource.labels.project_id:fw-ai-cp-prod logName:projects/fw-ai-cp-prod/logs/stderr timestamp:2023-08-10T04:02:44.414692091Z severity:ERROR resource.labels.cluster_name:control-plane-2 labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q resource.labels.namespace_name:default\n- labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q timestamp:2023-08-10T04:02:44.414687781Z resource.type:k8s_container resource.labels.namespace_name:default labels.k8s-pod/app_kubernetes_io/name:gateway receiveTimestamp:2023-08-10T04:02:44.780775649Z resource.labels.location:us-west1 labels.k8s-pod/app_kubernetes_io/instance:prod\n- resource.labels.cluster_name:control-plane-2 resource.labels.namespace_name:default labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q severity:ERROR resource.labels.pod_name:gateway-66b8b7c9b8-v8wfc labels.k8s-pod/app_kubernetes_io/name:gateway resource.type:k8s_container logName:projects/fw-ai-cp-prod/logs/stderr\n- resource.labels.namespace_name:default timestamp:2023-08-10T04:02:44.414657781Z insertId:p6pbm4xl7a8pxils labels.k8s-pod/app_kubernetes_io/instance:prod resource.labels.project_id:fw-ai-cp-prod labels.k8s-pod/pod-template-hash:66b8b7c9b8 severity:ERROR labels.k8s-pod/app_kubernetes_io/name:gateway\n- resource.labels.container_name:envoy labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q resource.labels.cluster_name:control-plane-2 resource.labels.namespace_name:default severity:ERROR labels.k8s-pod/app_kubernetes_io/instance:prod resource.labels.pod_name:gateway-66b8b7c9b8-v8wfc resource.type:k8s_container\n- labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q logName:projects/fw-ai-cp-prod/logs/stderr insertId:nfn4k8oh2kspj6bp labels.k8s-pod/app_kubernetes_io/name:gateway timestamp:2023-08-10T04:02:44.414625411Z labels.k8s-pod/pod-template-hash:66b8b7c9b8 resource.labels.cluster_name:control-plane-2 textPayload:\"[2023-08-10 04:02:44.414][1][debug][http] [source/common/http/conn_manager_impl.cc:306] [C14774] new stream\""}
{"query": "Show a sunburst chart of the coordination.k8s.io/v1.leases.update method errors categorized by cluster for logs coming from system:resource-tracker within the last 24 hours.", "request": "{\"query_str\": \"protoPayload.methodName:io.k8s.coordination.v1.leases.update protoPayload.authenticationInfo.principalEmail:system:resource-tracker\", \"groupby_fields\": [{\"path\": \"resource.labels.cluster_name\", \"limit\": 10, \"order\": \"top\"}], \"aggregation_function\": \"count\", \"aggregation_field\": \"count\", \"viz\": \"sunburst\", \"start\": \"now-24h\", \"end\": \"now\"}", "sample": "- operation.producer:k8s.io receiveTimestamp:2023-08-10T04:02:45.860467707Z resource.labels.location:us-west1 operation.id:c4ac37f9-30cb-43af-bcd9-14ddcaccdae2 timestamp:2023-08-10T04:02:43.920351Z labels.authorization.k8s.io/decision:allow resource.type:k8s_cluster protoPayload.@type:type.googleapis.com/google.cloud.audit.AuditLog protoPayload.methodName:io.k8s.coordination.v1.leases.update operation.first:True protoPayload.authorizationInfo[0].granted:True protoPayload.resourceName:coordination.k8s.io/v1/namespaces/kube-system/leases/ingress-gce-lock\n- resource.type:k8s_cluster resource.labels.location:us-west1 protoPayload.requestMetadata.callerIp:172.16.0.40 protoPayload.status.code:0 resource.labels.cluster_name:control-plane-2 insertId:e738d694-ebf2-44cd-a0ee-5f1062483887 operation.first:True protoPayload.requestMetadata.callerSuppliedUserAgent:\"kube-controller-manager/v1.26.5 (linux/amd64) kubernetes/4eb5737/leader-election\" labels.authorization.k8s.io/decision:allow logName:projects/fw-ai-cp-prod/logs/cloudaudit.googleapis.com%2Factivity operation.producer:k8s.io operation.id:e738d694-ebf2-44cd-a0ee-5f1062483887\n- resource.labels.cluster_name:inference-1 resource.labels.project_id:fw-ai-cp-prod protoPayload.status.code:0 operation.producer:k8s.io protoPayload.authorizationInfo[0].granted:True labels.authorization.k8s.io/reason:\"RBAC: allowed by ClusterRoleBinding \"system:cloud-controller-manager\" of ClusterRole \"system:cloud-controller-manager\" to User \"system:cloud-controller-manager\"\" operation.first:True protoPayload.methodName:io.k8s.coordination.v1.leases.update receiveTimestamp:2023-08-10T04:02:45.464356158Z operation.id:3a235139-1f92-45e9-9cff-ad3e272a0ef1 protoPayload.authenticationInfo.principalEmail:system:cloud-controller-manager insertId:3a235139-1f92-45e9-9cff-ad3e272a0ef1\n- operation.last:True resource.labels.location:us-central1-a protoPayload.methodName:io.k8s.coordination.v1.leases.update logName:projects/fw-ai-cp-prod/logs/cloudaudit.googleapis.com%2Factivity protoPayload.@type:type.googleapis.com/google.cloud.audit.AuditLog protoPayload.authenticationInfo.principalEmail:system:gke-common-webhooks operation.first:True protoPayload.serviceName:k8s.io resource.type:k8s_cluster protoPayload.requestMetadata.callerSuppliedUserAgent:\"gke-common-webhooks/v0.0.0 (linux/amd64) kubernetes/$Format\" protoPayload.authorizationInfo[0].permission:io.k8s.coordination.v1.leases.update protoPayload.authorizationInfo[0].resource:coordination.k8s.io/v1/namespaces/kube-system/leases/gke-common-webhook-lock\n- operation.last:True protoPayload.authenticationInfo.principalEmail:system:kube-scheduler insertId:3f78b7f7-e096-4464-8b64-018ed5949981 operation.first:True protoPayload.requestMetadata.callerSuppliedUserAgent:\"kube-scheduler/v1.26.5 (linux/amd64) kubernetes/4eb5737/leader-election\" resource.labels.location:us-west1 operation.id:3f78b7f7-e096-4464-8b64-018ed5949981 protoPayload.authorizationInfo[0].granted:True resource.labels.cluster_name:control-plane-2 protoPayload.resourceName:coordination.k8s.io/v1/namespaces/kube-system/leases/kube-scheduler protoPayload.methodName:io.k8s.coordination.v1.leases.update protoPayload.requestMetadata.callerIp:172.16.0.40\n- resource.labels.cluster_name:control-plane-2 resource.labels.namespace_name:default labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q labels.k8s-pod/app_kubernetes_io/instance:dev-james textPayload:\"[2023-08-10 04:02:43.752][1][debug][upstream] [source/extensions/clusters/logical_dns/logical_dns_cluster.cc:167] DNS refresh rate reset for 127.0.0.1, refresh rate 5000 ms\" resource.labels.pod_name:gateway-dev-james-bd68985fc-wjnv8 receiveTimestamp:2023-08-10T04:02:44.833586762Z resource.labels.project_id:fw-ai-cp-prod\n- logName:projects/fw-ai-cp-prod/logs/stderr insertId:avh0ixiu8li4gaos resource.type:k8s_container labels.k8s-pod/pod-template-hash:bd68985fc textPayload:\"[2023-08-10 04:02:43.752][1][debug][upstream] [source/extensions/clusters/logical_dns/logical_dns_cluster.cc:116] async DNS resolution complete for 127.0.0.1\" timestamp:2023-08-10T04:02:43.752284632Z receiveTimestamp:2023-08-10T04:02:44.833586762Z resource.labels.location:us-west1\n- receiveTimestamp:2023-08-10T04:02:44.833586762Z resource.labels.location:us-west1 resource.labels.cluster_name:control-plane-2 resource.labels.project_id:fw-ai-cp-prod labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q labels.k8s-pod/pod-template-hash:bd68985fc insertId:l6d679ixzxj6b0se resource.labels.container_name:envoy\n- resource.labels.project_id:fw-ai-cp-prod protoPayload.request.metadata.annotations.control-plane.alpha.kubernetes.io/leader:{\"holderIdentity\":\"gke-8582fd8c97fe42738837-decf-ba88-vm_50a6ff10-db03-4e70-8a66-183ac4ae95a9\",\"leaseDurationSeconds\":15,\"acquireTime\":\"2023-08-08T10:40:13Z\",\"renewTime\":\"2023-08-10T04:02:43Z\",\"leaderTransitions\":8} protoPayload.response.kind:Endpoints protoPayload.status.code:0 operation.id:5bfe8bdd-c1bd-440e-ae49-f751a73bb03c protoPayload.serviceName:k8s.io protoPayload.requestMetadata.callerSuppliedUserAgent:\"gke-resource-tracker/v0.0.0 (linux/amd64) kubernetes/$Format/resource-tracker\" protoPayload.request.metadata.managedFields[0].fieldsV1.f:\"metadata.f:annotations.f:control-plane.alpha.kubernetes.io/leader:  {}\" protoPayload.response.metadata.managedFields[0].fieldsType:FieldsV1 protoPayload.authorizationInfo[0].granted:True protoPayload.request.metadata.uid:8766f629-5d03-4a47-9e9f-b5f2b6383db8 protoPayload.request.metadata.creationTimestamp:2023-07-21T22:16:29Z protoPayload.request.metadata.managedFields[0].fieldsV1.f:\"metadata.f:annotations..:                                           {}\" insertId:5bfe8bdd-c1bd-440e-ae49-f751a73bb03c timestamp:2023-08-10T04:02:43.748743Z protoPayload.response.metadata.managedFields[0].fieldsV1.f:\"metadata.f:annotations.f:control-plane.alpha.kubernetes.io/leader: {}\" protoPayload.authenticationInfo.principalEmail:system:resource-tracker operation.producer:k8s.io operation.last:True protoPayload.request.metadata.managedFields[0].operation:Update protoPayload.resourceName:core/v1/namespaces/kube-system/endpoints/resource-tracker protoPayload.request.metadata.resourceVersion:15028468 resource.labels.location:us-central1-a protoPayload.response.metadata.name:resource-tracker protoPayload.response.metadata.creationTimestamp:2023-07-21T22:16:29Z protoPayload.response.metadata.managedFields[0].manager:gke-resource-tracker receiveTimestamp:2023-08-10T04:02:44.390338564Z protoPayload.request.metadata.managedFields[0].apiVersion:v1\n- timestamp:2023-08-10T04:02:43.747923Z protoPayload.resourceName:coordination.k8s.io/v1/namespaces/kube-system/leases/cloud-provider-extraction-migration-pt2 insertId:c05f1904-299b-480b-b87e-c67b618aeaae receiveTimestamp:2023-08-10T04:02:44.579781466Z protoPayload.authenticationInfo.principalEmail:system:cloud-controller-manager resource.type:k8s_cluster protoPayload.authorizationInfo[0].permission:io.k8s.coordination.v1.leases.update labels.authorization.k8s.io/decision:allow logName:projects/fw-ai-cp-prod/logs/cloudaudit.googleapis.com%2Factivity protoPayload.requestMetadata.callerSuppliedUserAgent:\"cloud-controller-manager/v1.26.4 (linux/amd64) kubernetes/ab1c709/leader-election\" protoPayload.serviceName:k8s.io resource.labels.location:us-central1-a"}
{"query": "Find the error logs from the gateway application across pods in the control-plane-2 cluster deployed in the last two hours, and output the count of logs for each kubernetes namespace through a sunburst visualization.", "request": "{\"query_str\": \"severity:ERROR resource.labels.cluster_name:control-plane-2 labels.k8s-pod/app_kubernetes_io/name:gateway\", \"groupby_fields\": [{\"path\": \"resource.labels.namespace_name\", \"limit\": 10, \"order\": \"top\"}], \"aggregation_function\": \"count\", \"aggregation_field\": \"count\", \"viz\": \"sunburst\", \"start\": \"now-2h\", \"end\": \"now\"}", "sample": "- resource.labels.cluster_name:control-plane-2 logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.location:us-west1 severity:ERROR resource.labels.namespace_name:default insertId:03wvx5o9bv34e77p textPayload:\"[2023-08-10 04:02:43.744][1][debug][dns] [source/extensions/network/dns_resolver/cares/dns_impl.cc:354] dns resolution for 127.0.0.1 started\" labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q\n- resource.type:k8s_container labels.k8s-pod/app_kubernetes_io/name:gateway resource.labels.location:us-west1 severity:ERROR labels.k8s-pod/pod-template-hash:bd68985fc timestamp:2023-08-10T04:02:43.744942552Z resource.labels.pod_name:gateway-dev-james-bd68985fc-wjnv8 textPayload:\"[2023-08-10 04:02:43.744][1][debug][upstream] [source/extensions/clusters/logical_dns/logical_dns_cluster.cc:108] starting async DNS resolution for 127.0.0.1\"\n- protoPayload.resourceName:core/v1/namespaces/kube-system/configmaps/clustermetrics resource.labels.cluster_name:control-plane-2 resource.labels.project_id:fw-ai-cp-prod operation.producer:k8s.io receiveTimestamp:2023-08-10T04:02:45.539014613Z protoPayload.@type:type.googleapis.com/google.cloud.audit.AuditLog resource.labels.location:us-west1 protoPayload.authorizationInfo[0].granted:True logName:projects/fw-ai-cp-prod/logs/cloudaudit.googleapis.com%2Factivity protoPayload.methodName:io.k8s.core.v1.configmaps.update protoPayload.serviceName:k8s.io labels.authorization.k8s.io/decision:allow\n- protoPayload.@type:type.googleapis.com/google.cloud.audit.AuditLog protoPayload.requestMetadata.callerSuppliedUserAgent:\"opencensus-go 0.23.0; stackdriver-exporter 0.13.3 grpc-go/1.26.0,gzip(gfe)\" protoPayload.request.name:projects/fw-ai-cp-prod protoPayload.serviceName:monitoring.googleapis.com protoPayload.requestMetadata.destinationAttributes:{} protoPayload.resourceName:projects/fw-ai-cp-prod severity:ERROR resource.labels.method:google.monitoring.v3.MetricService.CreateTimeSeries resource.labels.service:monitoring.googleapis.com protoPayload.status.code:7 protoPayload.methodName:google.monitoring.v3.MetricService.CreateTimeSeries protoPayload.authorizationInfo[0].resourceAttributes:{} protoPayload.authenticationInfo.principalSubject:serviceAccount:inference@fw-ai-cp-prod.iam.gserviceaccount.com protoPayload.requestMetadata.callerNetwork://compute.googleapis.com/projects/fw-ai-cp-prod/global/networks/__unknown__\n- insertId:11h3j3oeysxta protoPayload.status.message:\"Permission monitoring.timeSeries.create denied (or the resource may not exist).\" severity:ERROR timestamp:2023-08-10T04:02:43.656749693Z protoPayload.requestMetadata.callerIp:34.173.111.183 protoPayload.authenticationInfo.serviceAccountDelegationInfo[0].firstPartyPrincipal.principalEmail:service-331150806335@compute-system.iam.gserviceaccount.com protoPayload.authenticationInfo.principalEmail:inference@fw-ai-cp-prod.iam.gserviceaccount.com protoPayload.requestMetadata.destinationAttributes:{} protoPayload.authorizationInfo[0].permission:monitoring.timeSeries.create protoPayload.status.code:7 protoPayload.authorizationInfo[0].resourceAttributes:{} protoPayload.serviceName:monitoring.googleapis.com protoPayload.authorizationInfo[0].resource:331150806335 resource.labels.project_id:fw-ai-cp-prod\n- protoPayload.requestMetadata.callerSuppliedUserAgent:\"gcp-controller-manager/v0.0.0 (linux/amd64) kubernetes/$Format/leader-election\" protoPayload.authorizationInfo[0].permission:io.k8s.coordination.v1.leases.update resource.labels.project_id:fw-ai-cp-prod operation.producer:k8s.io protoPayload.status.code:0 protoPayload.methodName:io.k8s.coordination.v1.leases.update protoPayload.requestMetadata.callerIp:172.16.0.3 timestamp:2023-08-10T04:02:43.642175Z protoPayload.authorizationInfo[0].resource:coordination.k8s.io/v1/namespaces/kube-system/leases/gcp-controller-manager protoPayload.serviceName:k8s.io operation.id:a76b47c6-e18f-4cba-a5b0-ad4b19a48d6e insertId:a76b47c6-e18f-4cba-a5b0-ad4b19a48d6e\n- protoPayload.authorizationInfo[0].resource:coordination.k8s.io/v1/namespaces/kube-system/leases/cluster-autoscaler logName:projects/fw-ai-cp-prod/logs/cloudaudit.googleapis.com%2Factivity timestamp:2023-08-10T04:02:43.641426Z resource.labels.project_id:fw-ai-cp-prod protoPayload.status.code:0 insertId:3e9faa73-8d5f-461d-9d1e-a5cd49872623 protoPayload.authorizationInfo[0].granted:True labels.authorization.k8s.io/decision:allow receiveTimestamp:2023-08-10T04:02:44.510298633Z operation.first:True resource.labels.location:us-central1-a operation.producer:k8s.io\n- labels.k8s-pod/pod-template-hash:7f995f94f5 receiveTimestamp:2023-08-10T04:02:45.131915413Z textPayload:\"[2023-08-10 04:02:43.476][1][debug][main] [source/server/server.cc:265] flushing stats\" logName:projects/fw-ai-cp-prod/logs/stderr timestamp:2023-08-10T04:02:43.476954088Z resource.labels.pod_name:gateway-dev-bchen-7f995f94f5-j5nsd resource.labels.project_id:fw-ai-cp-prod labels.k8s-pod/app_kubernetes_io/instance:dev-bchen\n- protoPayload.serviceName:k8s.io protoPayload.resourceName:coordination.k8s.io/v1/namespaces/kube-system/leases/ingress-gce-lock protoPayload.authenticationInfo.principalEmail:system:l7-lb-controller resource.labels.cluster_name:inference-1 protoPayload.@type:type.googleapis.com/google.cloud.audit.AuditLog resource.labels.location:us-central1-a protoPayload.authorizationInfo[0].permission:io.k8s.coordination.v1.leases.update operation.first:True resource.labels.project_id:fw-ai-cp-prod labels.authorization.k8s.io/decision:allow timestamp:2023-08-10T04:02:43.438912Z protoPayload.requestMetadata.callerSuppliedUserAgent:\"glbc/v0.0.0 (linux/amd64) kubernetes/$Format/leader-election\"\n- resource.labels.project_id:fw-ai-cp-prod logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.container_name:envoy timestamp:2023-08-10T04:02:43.420548855Z resource.labels.location:us-west1 resource.type:k8s_container severity:ERROR resource.labels.cluster_name:control-plane-2"}
{"query": "Fetch the error logs from the application that goes by the name of gateway in the past hour, hailing from the us-west1 location, and aggregate them by the logName attribute, considering the top 10 most recurring entries only.", "request": "{\"query_str\": \"labels.k8s-pod/app_kubernetes_io/name:gateway status:error resource.labels.location:us-west1\", \"groupby_fields\": [{\"path\": \"logName\", \"limit\": 10, \"order\": \"top\"}], \"aggregation_function\": \"count\", \"aggregation_field\": \"count\", \"viz\": \"toplist\", \"start\": \"now-1h\", \"end\": \"now\"}", "sample": "- textPayload:\"[2023-08-10 04:02:43.420][1][debug][upstream] [source/extensions/clusters/logical_dns/logical_dns_cluster.cc:116] async DNS resolution complete for 127.0.0.1\" timestamp:2023-08-10T04:02:43.420522678Z resource.labels.cluster_name:control-plane-2 labels.k8s-pod/app_kubernetes_io/name:gateway resource.labels.project_id:fw-ai-cp-prod labels.k8s-pod/pod-template-hash:7f995f94f5 labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-382c7a95-oo3q resource.labels.container_name:envoy\n- resource.labels.location:us-west1 resource.labels.container_name:envoy labels.k8s-pod/pod-template-hash:7f995f94f5 resource.labels.pod_name:gateway-dev-bchen-7f995f94f5-j5nsd resource.labels.namespace_name:default labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-382c7a95-oo3q textPayload:\"[2023-08-10 04:02:43.420][1][debug][dns] [source/extensions/network/dns_resolver/cares/dns_impl.cc:275] dns resolution for 127.0.0.1 completed with status 0\" logName:projects/fw-ai-cp-prod/logs/stderr\n- labels.k8s-pod/app_kubernetes_io/name:gateway resource.labels.namespace_name:default resource.labels.location:us-west1 insertId:5zbmnwmytn3pyv4l labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-382c7a95-oo3q resource.labels.pod_name:gateway-dev-bchen-7f995f94f5-j5nsd labels.k8s-pod/app_kubernetes_io/instance:dev-bchen labels.k8s-pod/pod-template-hash:7f995f94f5\n- insertId:617qb91yfn42pxyl labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-382c7a95-oo3q resource.labels.project_id:fw-ai-cp-prod resource.labels.location:us-west1 resource.labels.namespace_name:default resource.labels.cluster_name:control-plane-2 receiveTimestamp:2023-08-10T04:02:45.131915413Z labels.k8s-pod/app_kubernetes_io/name:gateway\n- insertId:37af60f4-ae76-480a-b87b-6ec560e7b800 protoPayload.@type:type.googleapis.com/google.cloud.audit.AuditLog protoPayload.methodName:io.k8s.core.v1.configmaps.update protoPayload.authenticationInfo.principalEmail:system:serviceaccount:istio-system:istiod protoPayload.serviceName:k8s.io resource.type:k8s_cluster protoPayload.authorizationInfo[0].resource:core/v1/namespaces/istio-system/configmaps/istio-namespace-controller-election protoPayload.resourceName:core/v1/namespaces/istio-system/configmaps/istio-namespace-controller-election protoPayload.authorizationInfo[0].permission:io.k8s.core.v1.configmaps.update labels.authorization.k8s.io/reason:\"RBAC: allowed by ClusterRoleBinding \"istiod-clusterrole-istio-system\" of ClusterRole \"istiod-clusterrole-istio-system\" to ServiceAccount \"istiod/istio-system\"\" protoPayload.requestMetadata.callerSuppliedUserAgent:pilot-discovery/1.18.0 operation.last:True\n- protoPayload.authorizationInfo[0].granted:True protoPayload.requestMetadata.callerSuppliedUserAgent:pilot-discovery/1.18.0 protoPayload.authorizationInfo[0].permission:io.k8s.coordination.v1.leases.update protoPayload.@type:type.googleapis.com/google.cloud.audit.AuditLog receiveTimestamp:2023-08-10T04:02:44.105683444Z protoPayload.resourceName:coordination.k8s.io/v1/namespaces/istio-system/leases/istio-gateway-deployment-default operation.first:True resource.labels.project_id:fw-ai-cp-prod resource.type:k8s_cluster resource.labels.cluster_name:inference-1 insertId:7652d64c-4469-40d2-9859-2c57230377bb labels.authorization.k8s.io/reason:\"RBAC: allowed by RoleBinding \"istiod/istio-system\" of Role \"istiod\" to ServiceAccount \"istiod/istio-system\"\"\n- protoPayload.authorizationInfo[0].resource:core/v1/namespaces/istio-system/configmaps/istio-leader operation.last:True labels.authorization.k8s.io/reason:\"RBAC: allowed by ClusterRoleBinding \"istiod-clusterrole-istio-system\" of ClusterRole \"istiod-clusterrole-istio-system\" to ServiceAccount \"istiod/istio-system\"\" resource.type:k8s_cluster protoPayload.requestMetadata.callerIp:10.248.1.16 operation.id:376963a1-67b3-4a57-879f-3db0b57806ad receiveTimestamp:2023-08-10T04:02:44.417843420Z protoPayload.@type:type.googleapis.com/google.cloud.audit.AuditLog protoPayload.status.code:0 resource.labels.location:us-central1-a protoPayload.serviceName:k8s.io logName:projects/fw-ai-cp-prod/logs/cloudaudit.googleapis.com%2Factivity\n- insertId:c8529cfb-feff-4c11-9f43-dd0da6552452 protoPayload.methodName:io.k8s.core.v1.configmaps.update operation.first:True resource.type:k8s_cluster protoPayload.authorizationInfo[0].permission:io.k8s.core.v1.configmaps.update protoPayload.resourceName:core/v1/namespaces/istio-system/configmaps/istio-gateway-status-leader protoPayload.requestMetadata.callerSuppliedUserAgent:pilot-discovery/1.18.0 timestamp:2023-08-10T04:02:43.401178Z protoPayload.authenticationInfo.principalEmail:system:serviceaccount:istio-system:istiod resource.labels.location:us-central1-a protoPayload.status.code:0 protoPayload.requestMetadata.callerIp:10.248.1.16\n- severity:ERROR labels.k8s-pod/app_kubernetes_io/instance:dev timestamp:2023-08-10T04:02:43.385087948Z resource.labels.pod_name:gateway-dev-6bd9c99f49-f2rdx receiveTimestamp:2023-08-10T04:02:43.685484151Z resource.labels.cluster_name:control-plane-2 textPayload:\"[2023-08-10 04:02:43.384][1][debug][main] [source/server/server.cc:265] flushing stats\" resource.labels.project_id:fw-ai-cp-prod\n- resource.labels.project_id:fw-ai-cp-prod protoPayload.authenticationInfo.principalEmail:system:kube-scheduler insertId:d9252a69-944a-4406-bbcb-2cf187c1d3ef logName:projects/fw-ai-cp-prod/logs/cloudaudit.googleapis.com%2Factivity resource.labels.cluster_name:inference-1 operation.first:True timestamp:2023-08-10T04:02:43.328563Z receiveTimestamp:2023-08-10T04:02:44.310208453Z protoPayload.requestMetadata.callerIp:172.16.0.3 protoPayload.authorizationInfo[0].granted:True protoPayload.authorizationInfo[0].resource:coordination.k8s.io/v1/namespaces/kube-system/leases/kube-scheduler protoPayload.requestMetadata.callerSuppliedUserAgent:\"kube-scheduler/v1.26.5 (linux/amd64) kubernetes/4eb5737/leader-election\""}
{"query": "Show a timeseries of the count of error logs coming from the kube-system namespace for the fw-ai-cp-prod project, within a date range starting from the 1st to the 10th of August, 2023.", "request": "{\"query_str\": \"severity:ERROR resource.labels.project_id:fw-ai-cp-prod resource.labels.namespace_name:kube-system timestamp:[2023-08-01T00:00:00Z TO 2023-08-10T23:59:59Z]\", \"groupby_fields\": [], \"aggregation_function\": \"count\", \"aggregation_field\": \"count\", \"viz\": \"timeseries\", \"start\": \"2023-08-01T00:00:00Z\", \"end\": \"2023-08-10T23:59:59Z\"}", "sample": "- protoPayload.authorizationInfo[0].granted:True protoPayload.authorizationInfo[0].permission:io.k8s.core.v1.configmaps.update logName:projects/fw-ai-cp-prod/logs/cloudaudit.googleapis.com%2Factivity protoPayload.authenticationInfo.principalEmail:system:kubestore-collector protoPayload.resourceName:core/v1/namespaces/kube-system/configmaps/cluster-kubestore timestamp:2023-08-10T04:02:43.294947Z labels.authorization.k8s.io/reason:\"RBAC: allowed by ClusterRoleBinding \"system:kubestore-collector\" of ClusterRole \"system:kubestore-collector\" to User \"system:kubestore-collector\"\" resource.labels.project_id:fw-ai-cp-prod protoPayload.@type:type.googleapis.com/google.cloud.audit.AuditLog protoPayload.status.code:0 protoPayload.requestMetadata.callerIp:172.16.0.3 operation.first:True\n- protoPayload.resourceName:coordination.k8s.io/v1/namespaces/kube-system/leases/managed-certificate-controller protoPayload.authorizationInfo[0].resource:coordination.k8s.io/v1/namespaces/kube-system/leases/managed-certificate-controller insertId:142af8d2-7597-461e-b3c1-47a5d9d44716 protoPayload.authorizationInfo[0].permission:io.k8s.coordination.v1.leases.update operation.id:142af8d2-7597-461e-b3c1-47a5d9d44716 protoPayload.requestMetadata.callerIp:172.16.0.3 resource.type:k8s_cluster protoPayload.authenticationInfo.principalEmail:system:managed-certificate-controller protoPayload.serviceName:k8s.io protoPayload.authorizationInfo[0].granted:True operation.producer:k8s.io labels.authorization.k8s.io/decision:allow\n- labels.authorization.k8s.io/reason: protoPayload.methodName:io.k8s.coordination.v1.leases.update receiveTimestamp:2023-08-10T04:02:46.189393729Z resource.type:k8s_cluster protoPayload.authorizationInfo[0].granted:True protoPayload.serviceName:k8s.io protoPayload.requestMetadata.callerIp:172.16.0.40 operation.last:True resource.labels.cluster_name:control-plane-2 operation.id:5c2929a9-d115-4464-bc8e-64ecec8f871c protoPayload.@type:type.googleapis.com/google.cloud.audit.AuditLog timestamp:2023-08-10T04:02:43.279406Z\n- protoPayload.request.status.conditions[6].message:\"docker is functioning properly\" protoPayload.request.status.conditions[0].message:\"containerd is functioning properly\" protoPayload.status.code:0 protoPayload.request.status.conditions[5].reason:NoFrequentKubeletRestart protoPayload.request.status.conditions[4].status:False protoPayload.request.status.conditions[2].status:False protoPayload.@type:type.googleapis.com/google.cloud.audit.AuditLog protoPayload.request.status.conditions[4].lastTransitionTime:2023-07-30T12:09:28Z protoPayload.resourceName:core/v1/nodes/gke-control-plane-2-gateway-pool-ac2cab1a-8d6q/status protoPayload.request.status.conditions[2].reason:FilesystemIsNotReadOnly protoPayload.request.status.conditions[1].type:KernelDeadlock protoPayload.request.status.conditions[3].status:False protoPayload.request.status.conditions[5].type:FrequentKubeletRestart protoPayload.request.status.conditions[1].status:False protoPayload.request.status.conditions[0].reason:NoFrequentContainerdRestart insertId:b11d2832-551c-4ee6-bd49-53d656ed516b protoPayload.requestMetadata.callerSuppliedUserAgent:node-problem-detector/v0.8.13 receiveTimestamp:2023-08-10T04:02:45.351553368Z protoPayload.request.status.conditions[5].lastHeartbeatTime:2023-08-10T04:02:43Z resource.labels.cluster_name:control-plane-2 protoPayload.request.status.conditions[4].message:\"docker overlay2 is functioning properly\" protoPayload.authenticationInfo.principalEmail:system:node:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q protoPayload.request.status.conditions[6].lastTransitionTime:2023-07-30T12:09:28Z protoPayload.request.status.conditions[0].lastTransitionTime:2023-07-30T12:09:28Z protoPayload.request.status.conditions[2].type:ReadonlyFilesystem protoPayload.request.@type:k8s.io/Patch protoPayload.request.status.conditions[3].type:FrequentUnregisterNetDevice protoPayload.authorizationInfo[0].permission:io.k8s.core.v1.nodes.status.patch protoPayload.request.status.conditions[0].lastHeartbeatTime:2023-08-10T04:02:43Z resource.labels.project_id:fw-ai-cp-prod protoPayload.request.status.conditions[3].lastHeartbeatTime:2023-08-10T04:02:43Z protoPayload.request.status.conditions[6].status:False protoPayload.request.status.conditions[4].reason:NoCorruptDockerOverlay2 labels.authorization.k8s.io/decision:allow\n- labels.k8s-pod/pod-template-hash:5c5f868555 sourceLocation.file:client.go resource.labels.project_id:fw-ai-cp-prod insertId:sr41844rln6nwa16 severity:INFO resource.labels.pod_name:konnectivity-agent-5c5f868555-h9hpk logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.container_name:konnectivity-agent sourceLocation.line:208\n- protoPayload.authorizationInfo[0].permission:io.k8s.core.v1.configmaps.update operation.first:True timestamp:2023-08-10T04:02:43.186073Z operation.producer:k8s.io protoPayload.serviceName:k8s.io resource.type:k8s_cluster resource.labels.project_id:fw-ai-cp-prod protoPayload.authorizationInfo[0].granted:True protoPayload.authorizationInfo[0].resource:core/v1/namespaces/kube-system/configmaps/cluster-kubestore resource.labels.location:us-west1 operation.id:ae59887c-1fc4-4fa6-bb28-bb0129cd5fc3 protoPayload.requestMetadata.callerIp:172.16.0.38\n- timestamp:2023-08-10T04:02:43.128126783Z insertId:7cuusshjqlahfibw severity:ERROR resource.labels.namespace_name:default labels.k8s-pod/app_kubernetes_io/instance:dev textPayload:\"[2023-08-10 04:02:43.127][1][debug][upstream] [source/extensions/clusters/logical_dns/logical_dns_cluster.cc:167] DNS refresh rate reset for 127.0.0.1, refresh rate 5000 ms\" resource.labels.container_name:envoy labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-43c3fe28-geam\n- resource.labels.pod_name:gateway-dev-6bd9c99f49-f2rdx insertId:uaihh5d0cuhlss66 receiveTimestamp:2023-08-10T04:02:43.685484151Z resource.labels.namespace_name:default severity:ERROR textPayload:\"[2023-08-10 04:02:43.127][1][debug][upstream] [source/extensions/clusters/logical_dns/logical_dns_cluster.cc:116] async DNS resolution complete for 127.0.0.1\" labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-43c3fe28-geam resource.labels.project_id:fw-ai-cp-prod\n- receiveTimestamp:2023-08-10T04:02:43.685484151Z resource.labels.location:us-west1 labels.k8s-pod/app_kubernetes_io/name:gateway resource.labels.container_name:envoy resource.labels.pod_name:gateway-dev-6bd9c99f49-f2rdx labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-43c3fe28-geam logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.project_id:fw-ai-cp-prod\n- timestamp:2023-08-10T04:02:43.126858864Z resource.labels.location:us-west1 labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-43c3fe28-geam resource.labels.cluster_name:control-plane-2 resource.labels.project_id:fw-ai-cp-prod labels.k8s-pod/app_kubernetes_io/name:gateway labels.k8s-pod/pod-template-hash:6bd9c99f49 textPayload:\"[2023-08-10 04:02:43.126][1][debug][dns] [source/extensions/network/dns_resolver/cares/dns_impl.cc:354] dns resolution for 127.0.0.1 started\""}
{"query": "Generate a treemap visualization showing counts of error status logs for the projet fw-ai-cp-prod under the Kubernetes system namespace, categorized by cluster name within the last 24 hours.", "request": "{\"query_str\": \"labels.k8s-pod/namespace:kube-system status:error resource.labels.project_id:fw-ai-cp-prod\", \"groupby_fields\": [{\"path\":\"resource.labels.cluster_name\", \"limit\":10, \"order\":\"top\"}], \"aggregation_function\": \"count\", \"aggregation_field\": \"count\", \"viz\": \"treemap\", \"start\": \"now-24h\", \"end\": \"now\"}", "sample": "- resource.labels.project_id:fw-ai-cp-prod timestamp:2023-08-10T04:02:43.126654630Z textPayload:\"[2023-08-10 04:02:43.126][1][debug][upstream] [source/extensions/clusters/logical_dns/logical_dns_cluster.cc:108] starting async DNS resolution for 127.0.0.1\" labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-43c3fe28-geam insertId:5mdx8l7f0a8aihy3 logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.cluster_name:control-plane-2 resource.labels.location:us-west1\n- resource.labels.project_id:fw-ai-cp-prod resource.labels.location:us-central1-a operation.first:True protoPayload.authorizationInfo[0].permission:io.k8s.coordination.v1.leases.update protoPayload.requestMetadata.callerSuppliedUserAgent:\"webhook/v0.0.0 (linux/amd64) kubernetes/$Format\" protoPayload.status.code:0 labels.authorization.k8s.io/decision:allow protoPayload.methodName:io.k8s.coordination.v1.leases.update insertId:5009b47f-ddbc-4f4b-8344-2c6ec4615718 labels.authorization.k8s.io/reason:\"RBAC: allowed by ClusterRoleBinding \"knative-serving-controller-admin\" of ClusterRole \"knative-serving-admin\" to ServiceAccount \"controller/knative-serving\"\" timestamp:2023-08-10T04:02:43.122066Z protoPayload.requestMetadata.callerIp:10.248.1.5\n- logName:projects/fw-ai-cp-prod/logs/cloudaudit.googleapis.com%2Factivity protoPayload.requestMetadata.callerIp:10.248.1.5 resource.labels.location:us-central1-a labels.authorization.k8s.io/decision:allow protoPayload.serviceName:k8s.io protoPayload.methodName:io.k8s.coordination.v1.leases.update protoPayload.resourceName:coordination.k8s.io/v1/namespaces/knative-serving/leases/webhook.configmapwebhook.00-of-01 protoPayload.authenticationInfo.principalEmail:system:serviceaccount:knative-serving:controller operation.first:True operation.id:cbb0860e-7c5e-4c40-8ab1-93e0a707273e protoPayload.status.code:0 protoPayload.@type:type.googleapis.com/google.cloud.audit.AuditLog\n- protoPayload.resourceName:coordination.k8s.io/v1/namespaces/knative-serving/leases/webhook.validationwebhook.00-of-01 operation.last:True protoPayload.status.code:0 timestamp:2023-08-10T04:02:43.120450Z resource.labels.location:us-central1-a protoPayload.@type:type.googleapis.com/google.cloud.audit.AuditLog protoPayload.authorizationInfo[0].granted:True resource.labels.cluster_name:inference-1 receiveTimestamp:2023-08-10T04:02:44.107721740Z operation.first:True protoPayload.authenticationInfo.principalEmail:system:serviceaccount:knative-serving:controller protoPayload.methodName:io.k8s.coordination.v1.leases.update\n- protoPayload.resourceName:coordination.k8s.io/v1/namespaces/knative-serving/leases/webhook.webhookcertificates.00-of-01 labels.authorization.k8s.io/decision:allow protoPayload.requestMetadata.callerIp:10.248.1.5 protoPayload.authorizationInfo[0].permission:io.k8s.coordination.v1.leases.update labels.authorization.k8s.io/reason:\"RBAC: allowed by ClusterRoleBinding \"knative-serving-controller-admin\" of ClusterRole \"knative-serving-admin\" to ServiceAccount \"controller/knative-serving\"\" operation.id:f997e062-5c76-474b-93dc-9145c4775ebf resource.labels.cluster_name:inference-1 operation.last:True timestamp:2023-08-10T04:02:43.119780Z protoPayload.methodName:io.k8s.coordination.v1.leases.update operation.first:True operation.producer:k8s.io\n- timestamp:2023-08-10T04:02:43.112263Z labels.authorization.k8s.io/decision:allow protoPayload.authorizationInfo[0].granted:True protoPayload.requestMetadata.callerIp:172.16.0.40 protoPayload.status.code:0 protoPayload.@type:type.googleapis.com/google.cloud.audit.AuditLog protoPayload.authenticationInfo.principalEmail:system:gke-common-webhooks labels.authorization.k8s.io/reason:\"RBAC: allowed by ClusterRoleBinding \"system:gke-common-webhooks\" of ClusterRole \"system:gke-common-webhooks\" to User \"system:gke-common-webhooks\"\" resource.labels.cluster_name:control-plane-2 protoPayload.methodName:io.k8s.coordination.v1.leases.update operation.last:True logName:projects/fw-ai-cp-prod/logs/cloudaudit.googleapis.com%2Factivity\n- insertId:emj346ue65ikx71k textPayload:\"[2023-08-10 04:02:43.078][1][debug][main] [source/server/server.cc:265] flushing stats\" resource.labels.pod_name:gateway-dev-dzhulgakov-66f55647f4-4c6p8 timestamp:2023-08-10T04:02:43.078497324Z resource.labels.project_id:fw-ai-cp-prod resource.labels.container_name:envoy resource.labels.location:us-west1 resource.labels.cluster_name:control-plane-2\n- resource.labels.location:us-central1-a receiveTimestamp:2023-08-10T04:02:43.469902031Z protoPayload.@type:type.googleapis.com/google.cloud.audit.AuditLog protoPayload.authenticationInfo.principalEmail:system:clustermetrics operation.first:True protoPayload.status.code:0 operation.producer:k8s.io protoPayload.authorizationInfo[0].permission:io.k8s.core.v1.configmaps.update timestamp:2023-08-10T04:02:43.022320Z protoPayload.requestMetadata.callerSuppliedUserAgent:clustermetrics operation.id:ebedf4c7-c3f1-48e3-b41a-a922a5f842d3 protoPayload.authorizationInfo[0].granted:True\n- resource.labels.project_id:fw-ai-cp-prod labels.k8s-pod/controller-revision-hash:579d67b59 receiveTimestamp:2023-08-10T04:02:45.474681844Z timestamp:2023-08-10T04:02:42.796675122Z resource.labels.location:us-west1 labels.k8s-pod/k8s-app:gke-metrics-agent labels.k8s-pod/pod-template-generation:5 resource.labels.namespace_name:kube-system resource.labels.cluster_name:control-plane-2\n- textPayload:\"2023-08-10T04:02:42.796Z\terror\texporterhelper/queued_retry.go:101\tExporting failed. Dropping data. Try enabling sending_queue to survive temporary failures.\t{\"kind\": \"exporter\", \"name\": \"googlecloud\", \"dropped_items\": 20}\" logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.cluster_name:control-plane-2 timestamp:2023-08-10T04:02:42.796663788Z labels.k8s-pod/k8s-app:gke-metrics-agent labels.k8s-pod/component:gke-metrics-agent resource.labels.pod_name:gke-metrics-agent-hhlb9 resource.type:k8s_container insertId:62ba3qj8e7cupxmn"}
{"query": "Identify the distribution of error logs for the gateway application grouped by the container name originating from the kube-system namespace in the last hour.", "request": "{\"query_str\": \"textPayload:error labels.k8s-pod/app_kubernetes_io/name:gateway resource.labels.namespace_name:kube-system\", \"groupby_fields\": [{\"path\":\"resource.labels.container_name\", \"limit\":10, \"order\":\"top\"}], \"aggregation_function\": \"count\", \"aggregation_field\": \"count\", \"viz\": \"sunburst\", \"start\": \"now-1h\", \"end\": \"now\"}", "sample": "- receiveTimestamp:2023-08-10T04:02:45.474681844Z resource.type:k8s_container resource.labels.container_name:gke-metrics-agent labels.k8s-pod/pod-template-generation:5 labels.k8s-pod/component:gke-metrics-agent logName:projects/fw-ai-cp-prod/logs/stderr textPayload:\"2023-08-10T04:02:42.796Z\terror\texporterhelper/queued_retry.go:165\tExporting failed. Try enabling retry_on_failure config option.\t{\"kind\": \"exporter\", \"name\": \"googlecloud\", \"error\": \"rpc error: code = PermissionDenied desc = Permission monitoring.timeSeries.create denied (or the resource may not exist).\"}\" labels.k8s-pod/controller-revision-hash:579d67b59 resource.labels.namespace_name:kube-system\n- insertId:9x7qljtqxev6b8nz receiveTimestamp:2023-08-10T04:02:43.685443746Z labels.k8s-pod/app_kubernetes_io/name:gateway labels.k8s-pod/app_kubernetes_io/instance:prod resource.labels.pod_name:gateway-66b8b7c9b8-j7j4c logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.container_name:envoy resource.labels.location:us-west1\n- resource.labels.location:us-west1 resource.labels.pod_name:gateway-66b8b7c9b8-j7j4c timestamp:2023-08-10T04:02:42.757554035Z labels.k8s-pod/app_kubernetes_io/name:gateway labels.k8s-pod/pod-template-hash:66b8b7c9b8 insertId:prk92csxooi3aux7 labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-43c3fe28-geam resource.type:k8s_container\n- timestamp:2023-08-10T04:02:42.757480022Z severity:ERROR resource.labels.pod_name:gateway-66b8b7c9b8-j7j4c labels.k8s-pod/app_kubernetes_io/instance:prod resource.labels.namespace_name:default resource.labels.project_id:fw-ai-cp-prod labels.k8s-pod/app_kubernetes_io/name:gateway labels.k8s-pod/pod-template-hash:66b8b7c9b8\n- resource.labels.container_name:envoy resource.labels.pod_name:gateway-66b8b7c9b8-j7j4c resource.labels.cluster_name:control-plane-2 labels.k8s-pod/app_kubernetes_io/instance:prod resource.labels.namespace_name:default receiveTimestamp:2023-08-10T04:02:43.685443746Z timestamp:2023-08-10T04:02:42.755711744Z labels.k8s-pod/app_kubernetes_io/name:gateway\n- resource.labels.location:us-west1 resource.labels.namespace_name:default receiveTimestamp:2023-08-10T04:02:43.685443746Z textPayload:\"[2023-08-10 04:02:42.755][1][debug][upstream] [source/extensions/clusters/logical_dns/logical_dns_cluster.cc:108] starting async DNS resolution for 127.0.0.1\" resource.labels.pod_name:gateway-66b8b7c9b8-j7j4c timestamp:2023-08-10T04:02:42.755617192Z logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.project_id:fw-ai-cp-prod\n- protoPayload.requestMetadata.callerIp:10.1.0.107 protoPayload.authenticationInfo.serviceAccountDelegationInfo[0].firstPartyPrincipal.principalEmail:service-331150806335@compute-system.iam.gserviceaccount.com protoPayload.authenticationInfo.principalSubject:serviceAccount:fireworks-control-plane@fw-ai-cp-prod.iam.gserviceaccount.com protoPayload.serviceName:monitoring.googleapis.com protoPayload.@type:type.googleapis.com/google.cloud.audit.AuditLog resource.type:audited_resource protoPayload.requestMetadata.requestAttributes.time:2023-08-10T04:02:42.794381753Z timestamp:2023-08-10T04:02:42.608875383Z protoPayload.request.@type:type.googleapis.com/google.monitoring.v3.CreateTimeSeriesRequest protoPayload.methodName:google.monitoring.v3.MetricService.CreateServiceTimeSeries receiveTimestamp:2023-08-10T04:02:43.034769417Z resource.labels.method:google.monitoring.v3.MetricService.CreateServiceTimeSeries resource.labels.project_id:fw-ai-cp-prod protoPayload.requestMetadata.callerNetwork://compute.googleapis.com/projects/fw-ai-cp-prod/global/networks/__unknown__\n- resource.labels.service:monitoring.googleapis.com protoPayload.authenticationInfo.serviceAccountDelegationInfo[0].firstPartyPrincipal.principalEmail:service-331150806335@compute-system.iam.gserviceaccount.com protoPayload.authorizationInfo[0].resourceAttributes:{} protoPayload.authenticationInfo.principalEmail:inference@fw-ai-cp-prod.iam.gserviceaccount.com resource.labels.method:google.monitoring.v3.MetricService.CreateServiceTimeSeries protoPayload.authenticationInfo.principalSubject:serviceAccount:inference@fw-ai-cp-prod.iam.gserviceaccount.com protoPayload.status.code:7 protoPayload.requestMetadata.callerIp:35.239.48.145 resource.type:audited_resource protoPayload.@type:type.googleapis.com/google.cloud.audit.AuditLog protoPayload.authorizationInfo[0].resource:331150806335 severity:ERROR insertId:15wrvcteys728 resource.labels.project_id:fw-ai-cp-prod\n- protoPayload.requestMetadata.callerIp:10.0.0.6 protoPayload.authorizationInfo[0].granted:True labels.authorization.k8s.io/reason: protoPayload.methodName:io.k8s.coordination.v1.leases.update receiveTimestamp:2023-08-10T04:02:43.624171415Z insertId:5341c2fa-3090-4aaf-8379-b5165b1a7a98 labels.authorization.k8s.io/decision:allow logName:projects/fw-ai-cp-prod/logs/cloudaudit.googleapis.com%2Factivity operation.last:True protoPayload.authorizationInfo[0].resource:coordination.k8s.io/v1/namespaces/kube-node-lease/leases/gke-inference-1-a2-highgpu-8g-1-5bc5c01f-d6ex timestamp:2023-08-10T04:02:42.510180Z protoPayload.authenticationInfo.principalEmail:system:node:gke-inference-1-a2-highgpu-8g-1-5bc5c01f-d6ex\n- resource.labels.location:us-west1 textPayload:\"[2023-08-10 04:02:42.480][1][debug][upstream] [source/extensions/clusters/logical_dns/logical_dns_cluster.cc:167] DNS refresh rate reset for 127.0.0.1, refresh rate 5000 ms\" labels.k8s-pod/app_kubernetes_io/instance:preview resource.labels.project_id:fw-ai-cp-prod resource.labels.pod_name:gateway-preview-77f9d969b4-xfwx2 labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-382c7a95-oo3q timestamp:2023-08-10T04:02:42.481211506Z labels.k8s-pod/app_kubernetes_io/name:gateway"}
{"query": "For the last 6 hours, display a pattern visualization showing the count of error logs for the gateway application within the control-plane-2 cluster, categorized by the project id.", "request": "{\"query_str\": \"severity:ERROR labels.k8s-pod/app_kubernetes_io/name:gateway resource.labels.cluster_name:control-plane-2\", \"groupby_fields\": [{\"path\": \"resource.labels.project_id\", \"limit\": 10, \"order\": \"top\"}], \"aggregation_function\": \"count\", \"aggregation_field\": \"count\", \"viz\": \"pattern\", \"start\": \"now-6h\", \"end\": \"now\"}", "sample": "- labels.k8s-pod/app_kubernetes_io/instance:preview labels.k8s-pod/app_kubernetes_io/name:gateway resource.type:k8s_container resource.labels.location:us-west1 resource.labels.pod_name:gateway-preview-77f9d969b4-xfwx2 resource.labels.container_name:envoy resource.labels.project_id:fw-ai-cp-prod textPayload:\"[2023-08-10 04:02:42.480][1][debug][upstream] [source/extensions/clusters/logical_dns/logical_dns_cluster.cc:116] async DNS resolution complete for 127.0.0.1\"\n- resource.labels.cluster_name:control-plane-2 labels.k8s-pod/pod-template-hash:77f9d969b4 resource.type:k8s_container labels.k8s-pod/app_kubernetes_io/name:gateway logName:projects/fw-ai-cp-prod/logs/stderr timestamp:2023-08-10T04:02:42.481103221Z textPayload:\"[2023-08-10 04:02:42.480][1][debug][dns] [source/extensions/network/dns_resolver/cares/dns_impl.cc:275] dns resolution for 127.0.0.1 completed with status 0\" insertId:588rjrb6lunareb8\n- textPayload:\"[2023-08-10 04:02:42.476][1][debug][dns] [source/extensions/network/dns_resolver/cares/dns_impl.cc:354] dns resolution for 127.0.0.1 started\" severity:ERROR resource.labels.project_id:fw-ai-cp-prod resource.labels.namespace_name:default insertId:bzt94qehysr5a7xt labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-382c7a95-oo3q resource.labels.cluster_name:control-plane-2 labels.k8s-pod/app_kubernetes_io/name:gateway\n- resource.labels.pod_name:gateway-preview-77f9d969b4-xfwx2 resource.labels.container_name:envoy severity:ERROR logName:projects/fw-ai-cp-prod/logs/stderr labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-382c7a95-oo3q resource.labels.namespace_name:default resource.labels.cluster_name:control-plane-2 labels.k8s-pod/pod-template-hash:77f9d969b4\n- jsonPayload._CMDLINE:\"/home/kubernetes/bin/kubelet --v=2 --cloud-provider=external --experimental-mounter-path=/home/kubernetes/containerized_mounter/mounter --cert-dir=/var/lib/kubelet/pki/ --kubeconfig=/var/lib/kubelet/kubeconfig --max-pods=110 --register-with-taints=deployment=gateway:NoExecute --volume-plugin-dir=/home/kubernetes/flexvolume --node-status-max-images=25 --container-runtime=remote --container-runtime-endpoint=unix:///run/containerd/containerd.sock --runtime-cgroups=/system.slice/containerd.service --registry-qps=10 --registry-burst=20 --config /home/kubernetes/kubelet-config.yaml \"--pod-sysctls=net.core.somaxconn=1024,net.ipv4.conf.all.accept_redirects=0,net.ipv4.conf.all.forwarding=1,net.ipv4.conf.all.route_localnet=1,net.ipv4.conf.default.forwarding=1,net.ipv4.ip_forward=1,net.ipv4.tcp_fin_timeout=60,net.ipv4.tcp_keepalive_intvl=60,net.ipv4.tcp_keepalive_probes=5,net.ipv4.tcp_keepalive_time=300,net.ipv4.tcp_rmem=4096 87380 6291456,net.ipv4.tcp_syn_retries=6,net.ipv4.tcp_tw_reuse=0,net.ipv4.tcp_wmem=4096 16384 4194304,net.ipv4.udp_rmem_min=4096,net.ipv4.udp_wmem_min=4096,net.ipv6.conf.all.disable_ipv6=1,net.ipv6.conf.default.accept_ra=0,net.ipv6.conf.default.disable_ipv6=1,net.netfilter.nf_conntrack_generic_timeout=600,net.netfilter.nf_conntrack_tcp_be_liberal=1,net.netfilter.nf_conntrack_tcp_timeout_close_wait=3600,net.netfilter.nf_conntrack_tcp_timeout_established=86400\" --pod-infra-container-image=gke.gcr.io/pause:3.8@sha256:880e63f94b145e46f1b1082bb71b85e21f16b99b180b9996407d61240ceb9830\" jsonPayload._SYSTEMD_SLICE:system.slice resource.labels.location:us-west1 jsonPayload._UID:0 jsonPayload._SYSTEMD_UNIT:kubelet.service jsonPayload._PID:1985 resource.labels.node_name:gke-control-plane-2-gateway-pool-382c7a95-oo3q jsonPayload._STREAM_ID:7c6bd5b841864d35b952f5daf7feab68 timestamp:2023-08-10T04:02:42.464422Z jsonPayload._MACHINE_ID:2ccedecca1e9c233bfbc69f1eb0445f0 resource.labels.cluster_name:control-plane-2 jsonPayload._COMM:kubelet jsonPayload.PRIORITY:6 receiveTimestamp:2023-08-10T04:02:45.129967782Z\n- operation.id:9e22298c-5988-4bb5-ba35-2df091cded06 protoPayload.methodName:io.k8s.coordination.v1.leases.update protoPayload.authenticationInfo.principalEmail:system:gcp-controller-manager protoPayload.requestMetadata.callerSuppliedUserAgent:\"gcp-controller-manager/v0.0.0 (linux/amd64) kubernetes/$Format/leader-election\" labels.authorization.k8s.io/reason:\"RBAC: allowed by ClusterRoleBinding \"system:gcp-controller-manager\" of ClusterRole \"system:gcp-controller-manager\" to User \"system:gcp-controller-manager\"\" protoPayload.serviceName:k8s.io protoPayload.authorizationInfo[0].permission:io.k8s.coordination.v1.leases.update protoPayload.resourceName:coordination.k8s.io/v1/namespaces/kube-system/leases/gcp-controller-manager operation.last:True resource.labels.cluster_name:control-plane-2 resource.labels.project_id:fw-ai-cp-prod receiveTimestamp:2023-08-10T04:02:45.720847659Z\n- operation.id:81197a0f-27f7-44ad-b86c-ca42fd817027 operation.last:True receiveTimestamp:2023-08-10T04:02:43.577108890Z resource.labels.project_id:fw-ai-cp-prod protoPayload.authorizationInfo[0].resource:coordination.k8s.io/v1/namespaces/kube-system/leases/addon-manager logName:projects/fw-ai-cp-prod/logs/cloudaudit.googleapis.com%2Factivity protoPayload.requestMetadata.callerSuppliedUserAgent:\"addon-manager/1.26-v0.10 (1e4d968)\" protoPayload.status.code:0 protoPayload.authorizationInfo[0].granted:True operation.first:True insertId:81197a0f-27f7-44ad-b86c-ca42fd817027 protoPayload.serviceName:k8s.io\n- receiveTimestamp:2023-08-10T04:02:42.442858118Z protoPayload.status.message:\"Permission monitoring.timeSeries.create denied (or the resource may not exist).\" protoPayload.requestMetadata.callerNetwork://compute.googleapis.com/projects/fw-ai-cp-prod/global/networks/__unknown__ resource.labels.service:monitoring.googleapis.com protoPayload.methodName:google.monitoring.v3.MetricService.CreateServiceTimeSeries resource.type:audited_resource resource.labels.method:google.monitoring.v3.MetricService.CreateServiceTimeSeries protoPayload.requestMetadata.requestAttributes.time:2023-08-10T04:02:42.312707250Z protoPayload.authorizationInfo[0].resource:331150806335 protoPayload.requestMetadata.requestAttributes.auth:{} severity:ERROR protoPayload.status.code:7 logName:projects/fw-ai-cp-prod/logs/cloudaudit.googleapis.com%2Fdata_access protoPayload.authenticationInfo.principalSubject:serviceAccount:inference@fw-ai-cp-prod.iam.gserviceaccount.com\n- receiveTimestamp:2023-08-10T04:02:44.780775649Z resource.labels.location:us-west1 labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q severity:ERROR labels.k8s-pod/app_kubernetes_io/name:gateway resource.labels.pod_name:gateway-66b8b7c9b8-v8wfc resource.labels.project_id:fw-ai-cp-prod resource.type:k8s_container\n- receiveTimestamp:2023-08-10T04:02:44.780775649Z resource.type:k8s_container resource.labels.namespace_name:default labels.k8s-pod/pod-template-hash:66b8b7c9b8 resource.labels.project_id:fw-ai-cp-prod resource.labels.cluster_name:control-plane-2 logName:projects/fw-ai-cp-prod/logs/stderr severity:ERROR"}
{"query": "For the past hour, provide a stream of error logs from the container named envoy in the control-plane-2 Kubernetes cluster.", "request": "{\"query_str\": \"severity:ERROR resource.labels.container_name:envoy resource.labels.cluster_name:control-plane-2\", \"groupby_fields\": [], \"aggregation_function\": \"\", \"aggregation_field\": \"\", \"viz\": \"stream\", \"start\": \"now-1h\", \"end\": \"now\"}", "sample": "- resource.labels.project_id:fw-ai-cp-prod labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q resource.labels.pod_name:gateway-66b8b7c9b8-v8wfc textPayload:\"[2023-08-10 04:02:42.198][1][debug][connection] [source/common/network/connection_impl.cc:720] [C14773] write flush complete\" logName:projects/fw-ai-cp-prod/logs/stderr severity:ERROR labels.k8s-pod/app_kubernetes_io/name:gateway resource.labels.container_name:envoy\n- resource.type:k8s_container severity:ERROR resource.labels.container_name:envoy labels.k8s-pod/app_kubernetes_io/name:gateway textPayload:\"[2023-08-10 04:02:42.198][1][debug][conn_handler] [source/extensions/listener_managers/listener_manager/active_stream_listener_base.cc:120] [C14772] adding to cleanup list\" resource.labels.location:us-west1 resource.labels.project_id:fw-ai-cp-prod logName:projects/fw-ai-cp-prod/logs/stderr\n- resource.labels.container_name:envoy insertId:6u8s0whrlufh9ioi severity:ERROR resource.type:k8s_container logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.location:us-west1 timestamp:2023-08-10T04:02:42.199250471Z resource.labels.pod_name:gateway-66b8b7c9b8-v8wfc\n- labels.k8s-pod/app_kubernetes_io/instance:prod textPayload:\"[2023-08-10 04:02:42.198][1][debug][connection] [source/common/network/connection_impl.cc:720] [C14772] write flush complete\" insertId:5k8e7jd1ke3kcc7z resource.labels.cluster_name:control-plane-2 resource.labels.location:us-west1 timestamp:2023-08-10T04:02:42.199246041Z labels.k8s-pod/pod-template-hash:66b8b7c9b8 resource.labels.project_id:fw-ai-cp-prod\n- severity:ERROR timestamp:2023-08-10T04:02:42.199241161Z insertId:6myfvzs54jo5keop receiveTimestamp:2023-08-10T04:02:44.780775649Z resource.labels.project_id:fw-ai-cp-prod resource.labels.cluster_name:control-plane-2 labels.k8s-pod/pod-template-hash:66b8b7c9b8 resource.labels.container_name:envoy\n- resource.labels.namespace_name:default resource.labels.container_name:envoy resource.labels.project_id:fw-ai-cp-prod resource.type:k8s_container receiveTimestamp:2023-08-10T04:02:44.780775649Z labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q insertId:07o1bkpy30lmt4no labels.k8s-pod/app_kubernetes_io/name:gateway\n- resource.labels.pod_name:gateway-66b8b7c9b8-v8wfc labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q labels.k8s-pod/app_kubernetes_io/instance:prod receiveTimestamp:2023-08-10T04:02:44.780775649Z resource.labels.container_name:envoy insertId:n15cteb88w4dzvud severity:ERROR resource.labels.cluster_name:control-plane-2\n- labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q receiveTimestamp:2023-08-10T04:02:44.780775649Z resource.labels.namespace_name:default resource.labels.pod_name:gateway-66b8b7c9b8-v8wfc resource.type:k8s_container jsonPayload:{} timestamp:2023-08-10T04:02:42.199227951Z labels.k8s-pod/pod-template-hash:66b8b7c9b8\n- timestamp:2023-08-10T04:02:42.199224001Z resource.labels.project_id:fw-ai-cp-prod receiveTimestamp:2023-08-10T04:02:44.780775649Z labels.k8s-pod/pod-template-hash:66b8b7c9b8 labels.k8s-pod/app_kubernetes_io/instance:prod logName:projects/fw-ai-cp-prod/logs/stderr insertId:xmw8r3bltpustgfg resource.labels.location:us-west1\n- resource.labels.cluster_name:control-plane-2 resource.type:k8s_container insertId:fp04k7ny432yc03z receiveTimestamp:2023-08-10T04:02:44.780775649Z resource.labels.project_id:fw-ai-cp-prod labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q severity:ERROR labels.k8s-pod/app_kubernetes_io/instance:prod"}
{"query": "Present the top 10 template hashes for the error logs generated by the gateway application in the k8s production instance over the past 24 hours in a toplist representation.", "request": "{\"query_str\": \"severity:ERROR labels.k8s-pod/app_kubernetes_io/instance:prod labels.k8s-pod/app_kubernetes_io/name:gateway\", \"groupby_fields\": [{\"path\": \"labels.k8s-pod/pod-template-hash\", \"limit\": 10, \"order\": \"top\"}], \"aggregation_field\": \"count\", \"aggregation_function\": \"count\", \"viz\": \"toplist\", \"start\": \"now-24h\", \"end\": \"now\"}", "sample": "- resource.labels.project_id:fw-ai-cp-prod labels.k8s-pod/pod-template-hash:66b8b7c9b8 textPayload:\"'date', 'Thu, 10 Aug 2023 04:02:42 GMT'\" insertId:zixpt5sqox15gu3b severity:ERROR labels.k8s-pod/app_kubernetes_io/instance:prod labels.k8s-pod/app_kubernetes_io/name:gateway resource.type:k8s_container\n- labels.k8s-pod/app_kubernetes_io/instance:prod severity:ERROR labels.k8s-pod/pod-template-hash:66b8b7c9b8 textPayload:\"'x-content-type-options', 'nosniff'\" resource.type:k8s_container labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q insertId:3ulhzxirppih2i47 resource.labels.container_name:envoy\n- textPayload:\"'cache-control', 'no-cache, max-age=0'\" severity:ERROR resource.labels.container_name:envoy logName:projects/fw-ai-cp-prod/logs/stderr labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q resource.labels.cluster_name:control-plane-2 labels.k8s-pod/app_kubernetes_io/instance:prod timestamp:2023-08-10T04:02:42.199204621Z\n- resource.labels.namespace_name:default textPayload:\"'content-type', 'text/plain; charset=UTF-8'\" receiveTimestamp:2023-08-10T04:02:44.780775649Z logName:projects/fw-ai-cp-prod/logs/stderr labels.k8s-pod/app_kubernetes_io/name:gateway severity:ERROR resource.type:k8s_container labels.k8s-pod/pod-template-hash:66b8b7c9b8\n- labels.k8s-pod/app_kubernetes_io/name:gateway labels.k8s-pod/app_kubernetes_io/instance:prod resource.type:k8s_container insertId:w4iyq4dh52dzuifj receiveTimestamp:2023-08-10T04:02:44.780775649Z labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q timestamp:2023-08-10T04:02:42.199174611Z resource.labels.container_name:envoy\n- resource.labels.location:us-west1 logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.pod_name:gateway-66b8b7c9b8-v8wfc resource.labels.container_name:envoy insertId:tzoapnpymjukqexj labels.k8s-pod/app_kubernetes_io/name:gateway resource.labels.namespace_name:default labels.k8s-pod/app_kubernetes_io/instance:prod\n- logName:projects/fw-ai-cp-prod/logs/stderr textPayload:\"[2023-08-10 04:02:42.198][1][debug][http] [source/common/http/conn_manager_impl.cc:1530] [C14773][S14995296825172574360] closing connection due to connection close header\" resource.type:k8s_container resource.labels.location:us-west1 insertId:ppcfexmsh3byhg6g resource.labels.namespace_name:default severity:ERROR resource.labels.container_name:envoy\n- labels.k8s-pod/pod-template-hash:66b8b7c9b8 insertId:3vhk124a8er9rp52 resource.labels.location:us-west1 textPayload:\"[2023-08-10 04:02:42.198][1][debug][admin] [source/server/admin/admin_filter.cc:85] [C14773][S14995296825172574360] request complete: path: /ready\" labels.k8s-pod/app_kubernetes_io/instance:prod severity:ERROR resource.labels.namespace_name:default receiveTimestamp:2023-08-10T04:02:44.780775649Z\n- logName:projects/fw-ai-cp-prod/logs/stderr severity:ERROR resource.labels.location:us-west1 textPayload:\"[2023-08-10 04:02:42.198][1][debug][connection] [./source/common/network/connection_impl.h:92] [C14773] current connecting state: false\" resource.type:k8s_container labels.k8s-pod/pod-template-hash:66b8b7c9b8 resource.labels.namespace_name:default insertId:rouei2ndtr4ct3gt\n- resource.labels.container_name:envoy resource.labels.project_id:fw-ai-cp-prod labels.k8s-pod/app_kubernetes_io/name:gateway receiveTimestamp:2023-08-10T04:02:44.780775649Z textPayload:\"[2023-08-10 04:02:42.198][1][debug][http] [source/common/http/conn_manager_impl.cc:955] [C14773][S14995296825172574360] request end stream\" labels.k8s-pod/pod-template-hash:66b8b7c9b8 timestamp:2023-08-10T04:02:42.199152811Z severity:ERROR"}
{"query": "Find the total count of error messages that originated from project_id fw-ai-cp-prod, specifically from the Kubernetes pod named gateway-66b8b7c9b8-v8wfc and record the numbers based on each unique timestamp within the last hour.", "request": "{\"query_str\": \"resource.labels.project_id:fw-ai-cp-prod severity:ERROR resource.labels.pod_name:gateway-66b8b7c9b8-v8wfc\", \"groupby_fields\": [{\"path\": \"timestamp\", \"limit\": 10, \"order\": \"top\"}], \"aggregation_function\": \"count\", \"aggregation_field\": \"count\", \"viz\": \"timeseries\", \"start\": \"now-1h\", \"end\": \"now\"}", "sample": "- resource.labels.pod_name:gateway-66b8b7c9b8-v8wfc resource.labels.project_id:fw-ai-cp-prod receiveTimestamp:2023-08-10T04:02:44.780775649Z labels.k8s-pod/app_kubernetes_io/instance:prod resource.labels.location:us-west1 timestamp:2023-08-10T04:02:42.199148331Z resource.labels.container_name:envoy labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q\n- labels.k8s-pod/app_kubernetes_io/name:gateway labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q resource.labels.container_name:envoy resource.labels.pod_name:gateway-66b8b7c9b8-v8wfc labels.k8s-pod/app_kubernetes_io/instance:prod receiveTimestamp:2023-08-10T04:02:44.780775649Z resource.labels.cluster_name:control-plane-2 labels.k8s-pod/pod-template-hash:66b8b7c9b8\n- resource.labels.project_id:fw-ai-cp-prod labels.k8s-pod/app_kubernetes_io/name:gateway resource.labels.location:us-west1 labels.k8s-pod/app_kubernetes_io/instance:prod labels.k8s-pod/pod-template-hash:66b8b7c9b8 resource.labels.namespace_name:default resource.labels.cluster_name:control-plane-2 severity:ERROR\n- resource.labels.pod_name:gateway-66b8b7c9b8-v8wfc resource.labels.cluster_name:control-plane-2 textPayload:\"'user-agent', 'kube-probe/1.26'\" timestamp:2023-08-10T04:02:42.199136931Z resource.labels.location:us-west1 resource.labels.container_name:envoy resource.labels.namespace_name:default severity:ERROR\n- receiveTimestamp:2023-08-10T04:02:44.780775649Z resource.labels.namespace_name:default severity:ERROR logName:projects/fw-ai-cp-prod/logs/stderr labels.k8s-pod/app_kubernetes_io/instance:prod timestamp:2023-08-10T04:02:42.199132571Z resource.type:k8s_container resource.labels.project_id:fw-ai-cp-prod\n- resource.type:k8s_container receiveTimestamp:2023-08-10T04:02:44.780775649Z labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q labels.k8s-pod/pod-template-hash:66b8b7c9b8 timestamp:2023-08-10T04:02:42.199128641Z resource.labels.pod_name:gateway-66b8b7c9b8-v8wfc resource.labels.container_name:envoy insertId:yqmw864nl0bdqjwe\n- resource.labels.location:us-west1 resource.labels.project_id:fw-ai-cp-prod insertId:kuf7ozi4mz5vcl2r labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q resource.labels.namespace_name:default labels.k8s-pod/app_kubernetes_io/instance:prod resource.labels.pod_name:gateway-66b8b7c9b8-v8wfc labels.k8s-pod/app_kubernetes_io/name:gateway\n- labels.k8s-pod/app_kubernetes_io/name:gateway labels.k8s-pod/app_kubernetes_io/instance:prod labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q severity:ERROR logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.cluster_name:control-plane-2 textPayload:\"[2023-08-10 04:02:42.198][1][debug][http] [source/common/http/conn_manager_impl.cc:972] [C14773][S14995296825172574360] request headers complete (end_stream=true):\" timestamp:2023-08-10T04:02:42.199090751Z\n- receiveTimestamp:2023-08-10T04:02:44.780775649Z textPayload:\"[2023-08-10 04:02:42.198][1][debug][http] [source/common/http/conn_manager_impl.cc:306] [C14773] new stream\" labels.k8s-pod/pod-template-hash:66b8b7c9b8 insertId:nw69ru7qflhfovzb timestamp:2023-08-10T04:02:42.199086071Z logName:projects/fw-ai-cp-prod/logs/stderr labels.k8s-pod/app_kubernetes_io/name:gateway labels.k8s-pod/app_kubernetes_io/instance:prod\n- severity:ERROR labels.k8s-pod/app_kubernetes_io/instance:prod timestamp:2023-08-10T04:02:42.199080121Z resource.labels.location:us-west1 labels.k8s-pod/pod-template-hash:66b8b7c9b8 resource.labels.pod_name:gateway-66b8b7c9b8-v8wfc insertId:3sn40ujfd0rvw2pg labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q"}
{"query": "Generate a stream visualization of error logs generated by the Envoy container within the default namespace of the control-plane-2 cluster over the last 6 hours in the fw-ai-cp-prod project.", "request": "{\"query_str\": \"severity:ERROR resource.labels.container_name:envoy resource.labels.namespace_name:default resource.labels.cluster_name:control-plane-2 resource.labels.project_id:fw-ai-cp-prod\", \"groupby_fields\": [], \"aggregation_function\": \"\", \"aggregation_field\": \"\", \"viz\": \"stream\", \"start\": \"now-6h\", \"end\": \"now\"}", "sample": "- insertId:toa26il9yv19y4ef logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.pod_name:gateway-66b8b7c9b8-v8wfc resource.labels.location:us-west1 resource.labels.container_name:envoy labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q labels.k8s-pod/app_kubernetes_io/instance:prod resource.labels.cluster_name:control-plane-2\n- receiveTimestamp:2023-08-10T04:02:44.780775649Z resource.labels.project_id:fw-ai-cp-prod textPayload:\"[2023-08-10 04:02:42.198][1][debug][misc] [source/server/admin/admin_filter.cc:101] nextChunk: response.length=5 more_data=false end_stream=true\" logName:projects/fw-ai-cp-prod/logs/stderr labels.k8s-pod/app_kubernetes_io/instance:prod timestamp:2023-08-10T04:02:42.198505341Z resource.labels.cluster_name:control-plane-2 insertId:igcku38o5fbrmai8\n- resource.labels.project_id:fw-ai-cp-prod resource.labels.cluster_name:control-plane-2 severity:ERROR insertId:twwozzzacafsh9pd resource.labels.namespace_name:default resource.labels.location:us-west1 resource.type:k8s_container resource.labels.container_name:envoy\n- resource.labels.namespace_name:default resource.labels.cluster_name:control-plane-2 severity:ERROR resource.labels.pod_name:gateway-66b8b7c9b8-v8wfc labels.k8s-pod/app_kubernetes_io/instance:prod resource.labels.container_name:envoy textPayload:\"'connection', 'close'\" receiveTimestamp:2023-08-10T04:02:44.780775649Z\n- textPayload:\"'server', 'envoy'\" labels.k8s-pod/pod-template-hash:66b8b7c9b8 logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.namespace_name:default resource.type:k8s_container resource.labels.cluster_name:control-plane-2 severity:ERROR timestamp:2023-08-10T04:02:42.198484761Z\n- resource.labels.cluster_name:control-plane-2 labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q severity:ERROR resource.labels.pod_name:gateway-66b8b7c9b8-v8wfc resource.type:k8s_container labels.k8s-pod/app_kubernetes_io/instance:prod resource.labels.namespace_name:default timestamp:2023-08-10T04:02:42.198480271Z\n- labels.compute.googleapis.com/resource_name:gke-control-plane-2-gateway-pool-ac2cab1a-8d6q textPayload:\"'x-content-type-options', 'nosniff'\" severity:ERROR labels.k8s-pod/app_kubernetes_io/name:gateway timestamp:2023-08-10T04:02:42.198476291Z logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.container_name:envoy resource.labels.pod_name:gateway-66b8b7c9b8-v8wfc\n- resource.labels.namespace_name:default resource.labels.cluster_name:control-plane-2 resource.labels.pod_name:gateway-66b8b7c9b8-v8wfc logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.location:us-west1 labels.k8s-pod/app_kubernetes_io/name:gateway resource.labels.container_name:envoy timestamp:2023-08-10T04:02:42.198472351Z\n- insertId:beze8mjdgi9fj7be timestamp:2023-08-10T04:02:42.198466011Z labels.k8s-pod/pod-template-hash:66b8b7c9b8 logName:projects/fw-ai-cp-prod/logs/stderr resource.labels.container_name:envoy severity:ERROR resource.type:k8s_container labels.k8s-pod/app_kubernetes_io/instance:prod\n- resource.labels.location:us-west1 resource.labels.project_id:fw-ai-cp-prod labels.k8s-pod/pod-template-hash:66b8b7c9b8 insertId:8ty4qu1xbuz3t4hv severity:ERROR resource.type:k8s_container resource.labels.pod_name:gateway-66b8b7c9b8-v8wfc resource.labels.namespace_name:default"}
